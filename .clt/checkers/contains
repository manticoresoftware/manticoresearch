#!/usr/bin/env bash

# Check if two arguments are provided
if [ $# -ne 2 ]; then
	echo "Usage: $0 <patterns_file> <target_file>"
	exit 1
fi

PATTERNS_FILE=$1
TARGET_FILE=$2

# Check if files exist
if [ ! -f "$PATTERNS_FILE" ]; then
	echo "Error: Patterns file '$PATTERNS_FILE' does not exist"
	exit 1
fi

if [ ! -f "$TARGET_FILE" ]; then
	echo "Error: Target file '$TARGET_FILE' does not exist"
	exit 1
fi

# Read the target file content once
TARGET_CONTENT=$(cat "$TARGET_FILE")

# Flag to track if all patterns are found
all_found=true

# Process each line in the patterns file
while IFS= read -r pattern; do
	# Skip empty lines
	if [ -z "$pattern" ]; then
		continue
	fi

# Check if the pattern is contained in the target file
if ! echo "$TARGET_CONTENT" | grep -q "$pattern"; then
	echo "Pattern not found: '$pattern'"
	all_found=false
fi
done < "$PATTERNS_FILE"

# Exit with appropriate status
if [ "$all_found" = true ]; then
	echo "All patterns found successfully"
	exit 0
else
	echo "Some patterns were not found"
	exit 1
fi
