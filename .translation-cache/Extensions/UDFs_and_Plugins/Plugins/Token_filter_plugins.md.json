{
    "74d06504d4a202b759ebe74cc4c70889bc88aa81d93721828ad17972dea84e7e": {
        "original": "# Token filter plugins\n\nToken filter plugins allow you to implement a custom tokenizer that creates tokens according to custom rules. There are two types:\n\n* Index-time tokenizer declared by [index_token_filter](../../../Creating_a_table/NLP_and_tokenization/Low-level_tokenization.md#index_token_filter) in table settings\n* Query-time tokenizer declared by [token_filter](../../../Searching/Options.md#token_filter) OPTION directive\n\nIn the text processing pipeline, token filters will run after the base tokenizer processing occurs (which processes the text from fields or queries and creates tokens out of them).\n\n## Index-time tokenizer\n\nIndex-time tokenizer is created by `indexer` when indexing source data into a table or by an RT table when processing `INSERT` or `REPLACE` statements.\n\nPlugin is declared as `library name:plugin name:optional string of settings`. The init functions of the plugin can accept arbitrary settings that can be passed as a string in the format `option1=value1;option2=value2;..`.\n\nExample:\n\nCODE_BLOCK_0\n\nThe call workflow for index-time token filter is as follows:\n\n1.  `XXX_init()` gets called right after `indexer` creates token filter with an empty fields list and then after indexer gets the table schema with the actual fields list. It must return zero for successful initialization or an error description otherwise.\n2.  `XXX_begin_document` gets called only for RT table `INSERT`/`REPLACE` for every document. It must return zero for a successful call or an error description otherwise. Using OPTION `token_filter_options`, additional parameters/settings can be passed to the function.\nCODE_BLOCK_1\n3.  `XXX_begin_field` gets called once for each field prior to processing the field with the base tokenizer, with the field number as its parameter.\n4.  `XXX_push_token` gets called once for each new token produced by the base tokenizer, with the source token as its parameter. It must return the token, count of extra tokens made by the token filter, and delta position for the token.\n5.  `XXX_get_extra_token` gets called multiple times in case `XXX_push_token` reports extra tokens. It must return the token and delta position for that extra token.\n6.  `XXX_end_field` gets called once right after the source tokens from the current field are processed.\n7.  `XXX_deinit` gets called at the very end of indexing.\n\nThe following functions are mandatory to be defined: `XXX_begin_document`, `XXX_push_token`, and `XXX_get_extra_token`.\n\n## query-time token filter\n\nQuery-time tokenizer gets created on search each time full-text is invoked by every table involved.\n\nThe call workflow for query-time token filter is as follows:\n\n1.  `XXX_init()` gets called once per table prior to parsing the query with parameters - max token length and a string set by the `token_filter` option\nCODE_BLOCK_2\n    It must return zero for successful initialization or error description otherwise.\n2.  `XXX_push_token()` gets called once for each new token produced by the base tokenizer with parameters: token produced by the base tokenizer, pointer to raw token at source query string, and raw token length. It must return the token and delta position for the token.\n3.  `XXX_pre_morph()` gets called once for the token right before it gets passed to the morphology processor with a reference to the token and stopword flag. It might set the stopword flag to mark the token as a stopword.\n4.  `XXX_post_morph()` gets called once for the token after it is processed by the morphology processor with a reference to the token and stopword flag. It might set the stopword flag to mark the token as a stopword. It must return a flag, the non-zero value of which means to use the token prior to morphology processing.\n5.  `XXX_deinit()` gets called at the very end of query processing.\n\nAbsence of the functions is tolerated.\n\n<!-- proofread -->\n\n",
        "translations": {
            "chinese": "# \u4ee4\u724c\u8fc7\u6ee4\u5668\u63d2\u4ef6\n\n\u4ee4\u724c\u8fc7\u6ee4\u5668\u63d2\u4ef6\u5141\u8bb8\u60a8\u5b9e\u73b0\u6839\u636e\u81ea\u5b9a\u4e49\u89c4\u5219\u521b\u5efa\u4ee4\u724c\u7684\u81ea\u5b9a\u4e49\u5206\u8bcd\u5668\u3002\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\n\n* \u7531\u8868\u8bbe\u7f6e\u4e2d\u7684 [index_token_filter](../../../Creating_a_table/NLP_and_tokenization/Low-level_tokenization.md#index_token_filter) \u58f0\u660e\u7684\u7d22\u5f15\u65f6\u5206\u8bcd\u5668\n* \u7531 [token_filter](../../../Searching/Options.md#token_filter) OPTION \u6307\u4ee4\u58f0\u660e\u7684\u67e5\u8be2\u65f6\u5206\u8bcd\u5668\n\n\u5728\u6587\u672c\u5904\u7406\u7ba1\u9053\u4e2d\uff0c\u4ee4\u724c\u8fc7\u6ee4\u5668\u5c06\u5728\u57fa\u672c\u5206\u8bcd\u5668\u5904\u7406\u5b8c\u6210\u540e\u8fd0\u884c\uff08\u57fa\u672c\u5206\u8bcd\u5668\u5904\u7406\u6765\u81ea\u5b57\u6bb5\u6216\u67e5\u8be2\u7684\u6587\u672c\u5e76\u751f\u6210\u4ee4\u724c\uff09\u3002\n\n## \u7d22\u5f15\u65f6\u5206\u8bcd\u5668\n\n\u7d22\u5f15\u65f6\u5206\u8bcd\u5668\u7531 `indexer` \u5728\u5c06\u6e90\u6570\u636e\u7d22\u5f15\u5230\u8868\u4e2d\u65f6\u521b\u5efa\uff0c\u6216\u8005\u7531 RT \u8868\u5728\u5904\u7406 `INSERT` \u6216 `REPLACE` \u8bed\u53e5\u65f6\u521b\u5efa\u3002\n\n\u63d2\u4ef6\u58f0\u660e\u683c\u5f0f\u4e3a `library name:plugin name:optional string of settings`\u3002\u63d2\u4ef6\u7684\u521d\u59cb\u5316\u51fd\u6570\u53ef\u63a5\u53d7\u4efb\u610f\u8bbe\u7f6e\uff0c\u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u4ee5 `option1=value1;option2=value2;..` \u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u4f20\u9012\u3002\n\n\u793a\u4f8b\uff1a\n\nCODE_BLOCK_0\n\n\u7d22\u5f15\u65f6\u4ee4\u724c\u8fc7\u6ee4\u5668\u7684\u8c03\u7528\u5de5\u4f5c\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1.  `XXX_init()` \u5728 `indexer` \u521b\u5efa\u4ee4\u724c\u8fc7\u6ee4\u5668\u5e76\u4f20\u5165\u7a7a\u5b57\u6bb5\u5217\u8868\u540e\uff0c\u4ee5\u53ca\u5728 indexer \u83b7\u53d6\u8868\u7ed3\u6784\u53ca\u5b9e\u9645\u5b57\u6bb5\u5217\u8868\u540e\u88ab\u8c03\u7528\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u96f6\u8868\u793a\u521d\u59cb\u5316\u6210\u529f\uff0c\u5426\u5219\u8fd4\u56de\u9519\u8bef\u63cf\u8ff0\u3002\n2.  `XXX_begin_document` \u53ea\u5728 RT \u8868\u7684 `INSERT`/`REPLACE` \u6bcf\u4e2a\u6587\u6863\u65f6\u8c03\u7528\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u96f6\u8868\u793a\u8c03\u7528\u6210\u529f\uff0c\u5426\u5219\u8fd4\u56de\u9519\u8bef\u63cf\u8ff0\u3002\u901a\u8fc7 OPTION `token_filter_options`\uff0c\u53ef\u4ee5\u5411\u8be5\u51fd\u6570\u4f20\u9012\u989d\u5916\u53c2\u6570/\u8bbe\u7f6e\u3002\nCODE_BLOCK_1\n3.  `XXX_begin_field` \u5728\u5904\u7406\u5b57\u6bb5\u7684\u57fa\u672c\u5206\u8bcd\u5668\u4e4b\u524d\u5bf9\u6bcf\u4e2a\u5b57\u6bb5\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u4e3a\u5b57\u6bb5\u7f16\u53f7\u3002\n4.  `XXX_push_token` \u5bf9\u57fa\u672c\u5206\u8bcd\u5668\u751f\u6210\u7684\u6bcf\u4e2a\u65b0\u4ee4\u724c\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u4e3a\u6e90\u4ee4\u724c\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u4ee4\u724c\u3001\u7531\u4ee4\u724c\u8fc7\u6ee4\u5668\u4ea7\u751f\u7684\u989d\u5916\u4ee4\u724c\u6570\u91cf\u53ca\u8be5\u4ee4\u724c\u7684\u4f4d\u7f6e\u504f\u79fb\u3002\n5.  `XXX_get_extra_token` \u5982\u679c `XXX_push_token` \u6307\u51fa\u5b58\u5728\u989d\u5916\u4ee4\u724c\uff0c\u5219\u591a\u6b21\u8c03\u7528\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u989d\u5916\u4ee4\u724c\u53ca\u5176\u4f4d\u7f6e\u504f\u79fb\u3002\n6.  `XXX_end_field` \u5728\u5f53\u524d\u5b57\u6bb5\u7684\u6e90\u4ee4\u724c\u5904\u7406\u5b8c\u6210\u540e\u8c03\u7528\u4e00\u6b21\u3002\n7.  `XXX_deinit` \u5728\u7d22\u5f15\u7ed3\u675f\u65f6\u8c03\u7528\u3002\n\n\u5fc5\u987b\u5b9a\u4e49\u4ee5\u4e0b\u51fd\u6570\uff1a`XXX_begin_document`\u3001`XXX_push_token` \u548c `XXX_get_extra_token`\u3002\n\n## \u67e5\u8be2\u65f6\u4ee4\u724c\u8fc7\u6ee4\u5668\n\n\u67e5\u8be2\u65f6\u5206\u8bcd\u5668\u5728\u6bcf\u6b21\u5168\u6587\u641c\u7d22\u8c03\u7528\u65f6\uff0c\u5bf9\u6240\u6d89\u53ca\u7684\u6bcf\u4e2a\u8868\u90fd\u4f1a\u521b\u5efa\u3002\n\n\u67e5\u8be2\u65f6\u4ee4\u724c\u8fc7\u6ee4\u5668\u7684\u8c03\u7528\u5de5\u4f5c\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1.  `XXX_init()` \u5728\u89e3\u6790\u67e5\u8be2\u4e4b\u524d\u5bf9\u6bcf\u4e2a\u8868\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u4e3a\u6700\u5927\u4ee4\u724c\u957f\u5ea6\u548c\u901a\u8fc7 `token_filter` \u9009\u9879\u8bbe\u7f6e\u7684\u5b57\u7b26\u4e32\nCODE_BLOCK_2\n    \u5b83\u5fc5\u987b\u8fd4\u56de\u96f6\u8868\u793a\u521d\u59cb\u5316\u6210\u529f\uff0c\u5426\u5219\u8fd4\u56de\u9519\u8bef\u63cf\u8ff0\u3002\n2.  `XXX_push_token()` \u5bf9\u57fa\u672c\u5206\u8bcd\u5668\u751f\u6210\u7684\u6bcf\u4e2a\u4ee4\u724c\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u5305\u62ec\u57fa\u672c\u5206\u8bcd\u5668\u751f\u6210\u7684\u4ee4\u724c\u3001\u6e90\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u7684\u539f\u59cb\u4ee4\u724c\u6307\u9488\u548c\u539f\u59cb\u4ee4\u724c\u957f\u5ea6\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u4ee4\u724c\u53ca\u5176\u4f4d\u7f6e\u504f\u79fb\u3002\n3.  `XXX_pre_morph()` \u5728\u4ee4\u724c\u4f20\u9012\u7ed9\u5f62\u6001\u5b66\u5904\u7406\u5668\u524d\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u4e3a\u4ee4\u724c\u5f15\u7528\u548c\u505c\u7528\u8bcd\u6807\u5fd7\u3002\u8be5\u51fd\u6570\u53ef\u80fd\u4f1a\u8bbe\u7f6e\u505c\u7528\u8bcd\u6807\u5fd7\uff0c\u5c06\u8be5\u4ee4\u724c\u6807\u8bb0\u4e3a\u505c\u7528\u8bcd\u3002\n4.  `XXX_post_morph()` \u5728\u4ee4\u724c\u7ecf\u8fc7\u5f62\u6001\u5b66\u5904\u7406\u5668\u5904\u7406\u540e\u8c03\u7528\u4e00\u6b21\uff0c\u53c2\u6570\u4e3a\u4ee4\u724c\u5f15\u7528\u548c\u505c\u7528\u8bcd\u6807\u5fd7\u3002\u8be5\u51fd\u6570\u53ef\u80fd\u4f1a\u8bbe\u7f6e\u505c\u7528\u8bcd\u6807\u5fd7\uff0c\u5c06\u8be5\u4ee4\u724c\u6807\u8bb0\u4e3a\u505c\u7528\u8bcd\u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u6807\u5fd7\uff0c\u975e\u96f6\u8868\u793a\u4f7f\u7528\u5f62\u6001\u5b66\u5904\u7406\u524d\u7684\u4ee4\u724c\u3002\n5.  `XXX_deinit()` \u5728\u67e5\u8be2\u5904\u7406\u7ed3\u675f\u65f6\u8c03\u7528\u3002\n\n\u7f3a\u5c11\u8fd9\u4e9b\u51fd\u6570\u662f\u5141\u8bb8\u7684\u3002\n\n<!-- proofread -->",
            "russian": "# \u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432 \u0442\u043e\u043a\u0435\u043d\u043e\u0432\n\n\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u043c \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c. \u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0434\u0432\u0430 \u0442\u0438\u043f\u0430:\n\n* \u0422\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e [index_token_filter](../../../Creating_a_table/NLP_and_tokenization/Low-level_tokenization.md#index_token_filter) \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\n* \u0422\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u0438\u0432\u043e\u0439 OPTION [token_filter](../../../Searching/Options.md#token_filter)\n\n\u0412 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0442\u0435\u043a\u0441\u0442\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u044b \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0431\u0430\u0437\u043e\u0432\u043e\u0433\u043e \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u0430 (\u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u0438\u0437 \u043f\u043e\u043b\u0435\u0439 \u0438\u043b\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u043e\u043a\u0435\u043d\u044b \u0438\u0437 \u043d\u0438\u0445).\n\n## \u0422\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n\n\u0422\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f `indexer` \u043f\u0440\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0438\u043b\u0438 RT \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432 `INSERT` \u0438\u043b\u0438 `REPLACE`.\n\n\u041f\u043b\u0430\u0433\u0438\u043d \u043e\u0431\u044a\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a\u0430\u043a `\u0438\u043c\u044f \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438:\u0438\u043c\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u0430:\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a`. \u0424\u0443\u043d\u043a\u0446\u0438\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u043c\u043e\u0433\u0443\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432 \u0432\u0438\u0434\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 `option1=value1;option2=value2;..`.\n\n\u041f\u0440\u0438\u043c\u0435\u0440:\n\nCODE_BLOCK_0\n\n\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0437\u043e\u0432\u043e\u0432 \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f:\n\n1.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_init()` \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a `indexer` \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0444\u0438\u043b\u044c\u0442\u0440 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0441 \u043f\u0443\u0441\u0442\u044b\u043c \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u043f\u043e\u043b\u0435\u0439, \u0430 \u0437\u0430\u0442\u0435\u043c \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a indexer \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0441\u0445\u0435\u043c\u0443 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0441 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u043f\u043e\u043b\u0435\u0439. \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043d\u043e\u043b\u044c \u043f\u0440\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435.\n2.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_begin_document` \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f RT \u0442\u0430\u0431\u043b\u0438\u0446 \u043f\u0440\u0438 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f\u0445 `INSERT`/`REPLACE` \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430. \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043d\u043e\u043b\u044c \u043f\u0440\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u043c \u0432\u044b\u0437\u043e\u0432\u0435 \u0438\u043b\u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435. \u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e OPTION `token_filter_options` \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b/\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044e.\nCODE_BLOCK_1\n3.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_begin_field` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044f \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u043f\u043e\u043b\u044f \u0431\u0430\u0437\u043e\u0432\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u043c, \u0441 \u043d\u043e\u043c\u0435\u0440\u043e\u043c \u043f\u043e\u043b\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430.\n4.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_push_token` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u043e\u043a\u0435\u043d\u0430, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0431\u0430\u0437\u043e\u0432\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u043c, \u0441 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u043e\u043c \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430. \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0442\u043e\u043a\u0435\u043d\u043e\u0432, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c \u0442\u043e\u043a\u0435\u043d\u043e\u0432, \u0438 \u0434\u0435\u043b\u044c\u0442\u0443 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0434\u043b\u044f \u0442\u043e\u043a\u0435\u043d\u0430.\n5.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_get_extra_token` \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 `XXX_push_token` \u0441\u043e\u043e\u0431\u0449\u0430\u0435\u0442 \u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0442\u043e\u043a\u0435\u043d\u0430\u0445. \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0438 \u0434\u0435\u043b\u044c\u0442\u0443 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0442\u043e\u043a\u0435\u043d\u0430.\n6.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_end_field` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0445 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044f.\n7.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_deinit` \u0432 \u0441\u0430\u043c\u043e\u043c \u043a\u043e\u043d\u0446\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u0438.\n\n\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f: `XXX_begin_document`, `XXX_push_token` \u0438 `XXX_get_extra_token`.\n\n## \u0424\u0438\u043b\u044c\u0442\u0440 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430\n\n\u0422\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043f\u043e\u0438\u0441\u043a\u0435 \u043f\u043e\u043b\u043d\u043e\u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b.\n\n\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u0437\u043e\u0432\u043e\u0432 \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f:\n\n1.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_init()` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0434\u043e \u0440\u0430\u0437\u0431\u043e\u0440\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u0442\u043e\u043a\u0435\u043d\u0430 \u0438 \u0441\u0442\u0440\u043e\u043a\u0430, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u0430\u044f \u043e\u043f\u0446\u0438\u0435\u0439 `token_filter`\nCODE_BLOCK_2\n    \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043d\u043e\u043b\u044c \u043f\u0440\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435.\n2.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_push_token()` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043d\u043e\u0432\u043e\u0433\u043e \u0442\u043e\u043a\u0435\u043d\u0430, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0431\u0430\u0437\u043e\u0432\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u043c, \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438: \u0442\u043e\u043a\u0435\u043d, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0431\u0430\u0437\u043e\u0432\u044b\u043c \u0442\u043e\u043a\u0435\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u043c, \u0443\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c \u043d\u0430 \u043d\u0435\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u0432 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0434\u043b\u0438\u043d\u0430 \u043d\u0435\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u043e\u043a\u0435\u043d\u0430. \u041e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0438 \u0434\u0435\u043b\u044c\u0442\u0443 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0434\u043b\u044f \u0442\u043e\u043a\u0435\u043d\u0430.\n3.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_pre_morph()` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u043f\u0435\u0440\u0435\u0434 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435\u0439 \u0432 \u043c\u043e\u0440\u0444\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440 \u0441 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0442\u043e\u043a\u0435\u043d \u0438 \u0444\u043b\u0430\u0433\u0430 \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u0430. \u041c\u043e\u0436\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u0444\u043b\u0430\u0433 \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u0430, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u043a\u0430\u043a \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u043e.\n4.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_post_morph()` \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u043e\u043a\u0435\u043d\u0430 \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043c\u043e\u0440\u0444\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043e\u043c \u0441 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0442\u043e\u043a\u0435\u043d \u0438 \u0444\u043b\u0430\u0433\u0430 \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u0430. \u041c\u043e\u0436\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u0444\u043b\u0430\u0433 \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u0430, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u043a\u0430\u043a \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u043e. \u0414\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0444\u043b\u0430\u0433, \u043d\u0435\u043d\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u0430 \u0434\u043e \u043c\u043e\u0440\u0444\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438.\n5.  \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f `XXX_deinit()` \u0432 \u0441\u0430\u043c\u043e\u043c \u043a\u043e\u043d\u0446\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430.\n\n\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f.\n\n<!-- proofread -->"
        },
        "is_code_or_comment": false,
        "model": "openai:gpt-4.1-mini",
        "updated_at": 1766339827
    },
    "__meta": {
        "source_text": "# Token filter plugins\n\nToken filter plugins allow you to implement a custom tokenizer that creates tokens according to custom rules. There are two types:\n\n* Index-time tokenizer declared by [index_token_filter](../../../Creating_a_table/NLP_and_tokenization/Low-level_tokenization.md#index_token_filter) in table settings\n* Query-time tokenizer declared by [token_filter](../../../Searching/Options.md#token_filter) OPTION directive\n\nIn the text processing pipeline, token filters will run after the base tokenizer processing occurs (which processes the text from fields or queries and creates tokens out of them).\n\n## Index-time tokenizer\n\nIndex-time tokenizer is created by `indexer` when indexing source data into a table or by an RT table when processing `INSERT` or `REPLACE` statements.\n\nPlugin is declared as `library name:plugin name:optional string of settings`. The init functions of the plugin can accept arbitrary settings that can be passed as a string in the format `option1=value1;option2=value2;..`.\n\nExample:\n\n```ini\nindex_token_filter = my_lib.so:email_process:field=email;split=.io\n```\n\nThe call workflow for index-time token filter is as follows:\n\n1.  `XXX_init()` gets called right after `indexer` creates token filter with an empty fields list and then after indexer gets the table schema with the actual fields list. It must return zero for successful initialization or an error description otherwise.\n2.  `XXX_begin_document` gets called only for RT table `INSERT`/`REPLACE` for every document. It must return zero for a successful call or an error description otherwise. Using OPTION `token_filter_options`, additional parameters/settings can be passed to the function.\n    ```sql\n    INSERT INTO rt (id, title) VALUES (1, 'some text corp@space.io') OPTION token_filter_options='.io'\n    ```\n3.  `XXX_begin_field` gets called once for each field prior to processing the field with the base tokenizer, with the field number as its parameter.\n4.  `XXX_push_token` gets called once for each new token produced by the base tokenizer, with the source token as its parameter. It must return the token, count of extra tokens made by the token filter, and delta position for the token.\n5.  `XXX_get_extra_token` gets called multiple times in case `XXX_push_token` reports extra tokens. It must return the token and delta position for that extra token.\n6.  `XXX_end_field` gets called once right after the source tokens from the current field are processed.\n7.  `XXX_deinit` gets called at the very end of indexing.\n\nThe following functions are mandatory to be defined: `XXX_begin_document`, `XXX_push_token`, and `XXX_get_extra_token`.\n\n## query-time token filter\n\nQuery-time tokenizer gets created on search each time full-text is invoked by every table involved.\n\nThe call workflow for query-time token filter is as follows:\n\n1.  `XXX_init()` gets called once per table prior to parsing the query with parameters - max token length and a string set by the `token_filter` option\n    ```sql\n    SELECT * FROM index WHERE MATCH ('test') OPTION token_filter='my_lib.so:query_email_process:io'\n    ```\n    It must return zero for successful initialization or error description otherwise.\n2.  `XXX_push_token()` gets called once for each new token produced by the base tokenizer with parameters: token produced by the base tokenizer, pointer to raw token at source query string, and raw token length. It must return the token and delta position for the token.\n3.  `XXX_pre_morph()` gets called once for the token right before it gets passed to the morphology processor with a reference to the token and stopword flag. It might set the stopword flag to mark the token as a stopword.\n4.  `XXX_post_morph()` gets called once for the token after it is processed by the morphology processor with a reference to the token and stopword flag. It might set the stopword flag to mark the token as a stopword. It must return a flag, the non-zero value of which means to use the token prior to morphology processing.\n5.  `XXX_deinit()` gets called at the very end of query processing.\n\nAbsence of the functions is tolerated.\n\n<!-- proofread -->\n\n",
        "updated_at": 1768530797,
        "source_md5": "490b6dad9deb92e980cb3efa71596552"
    }
}