{
  "6a094b9f4cf242dc2fffac8c05e85218d1707d1799720e7cd41c59e89345e3cb": {
    "original": "2. The old `manticore.json` file must not exist.\n\n3. The old configuration file must not exist.\n\n4. The old data directory must exist and be empty.\n\nIf all conditions are met, the restore will proceed. The tool will provide hints, so you don't have to memorize them. It's crucial to avoid overwriting existing files, so make sure to remove them prior to the restore if they still exist. Hence all the conditions.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Backup and restore with mysqldump\n\nManticore supports `mysqldump` utility from MySQL up to 9.5 and `mariadb-dump` utility from MariaDB up to 12.0.\n\n<!-- example mysqldump_backup -->\n\n> NOTE: some versions of `mysqldump` / `mariadb-dump` require [Manticore Buddy](../Installation/Manticore_Buddy.md). If the dump isn't working, make sure Buddy is installed.\n\nTo create a backup of your Manticore Search database, you can use the `mysqldump` command. We will use the default port and host in the examples.\n\nNote, `mysqldump` is supported only for real-time tables.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nExecuting this command will produce a backup file named `manticore_backup.sql`. This file will hold all data and table schemas.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nThis will produce a backup file `tbl.sql` with `replace` commands instead of `insert`, with column names retained in each batch. Documents will be batched up to 16 megabytes large. There will be no `drop`/`create table` commands. This is useful for full-text reindexation after changing tokenization settings.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nIn this case, `mysqldump` will generate commands like `REPLACE INTO cluster:table ...`, which will be sent directly to the Manticore instance, resulting in the documents being reinserted.\n\nUse the `cluster` user and the `-t` flag to enable replication mode. See the details in the notes below.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Restore\n\nIf you're looking to restore a Manticore Search database from a backup file, the mysql client is your tool of choice.\n\nNote, if you are restoring in [Plain mode](../Read_this_first.md#Real-time-mode-vs-plain-mode), you cannot drop and recreate tables directly. Therefore, you should:\n\n- Use `mysqldump` with the `-t` option to exclude `CREATE TABLE` statements from your backup.\n\n- Manually [TRUNCATE](../Emptying_a_table.md) the tables before proceeding with the restoration.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nThis command enables you to restore everything from the `manticore_backup.sql` file.\n\n<!-- end -->\n\n### Additional options\n\nHere are some more settings that can be used with mysqldump to tailor your backup:\n\n- `-t` skips `drop`/`create` table commands. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--no-data`: This setting omits table data from the backup, resulting in a backup file that consists only of table schemas.\n\n- `--ignore-table=[database_name].[table_name]`: This option allows you to bypass a particular table during the backup operation. Note that the database name must be `manticore`.\n\n- `--replace` to perform `replace` instead of `insert`. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--net-buffer-length=16M` to make batches up to 16 megabytes large for faster restoration.\n\n- `-e` to batch up documents. Useful for faster restoration.\n\n- `-c` to keep column names. Useful for reindexation of a table after changing its schema (e.g., changing field order).\n\nFor a comprehensive list of settings and their thorough descriptions, kindly refer to the official [MySQL documentation](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) or [MariaDB documentation](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Notes\n\n* To create a dump in replication mode (where the dump includes `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Use the `cluster` user. For example: `mysqldump -u cluster ...` or `mariadb-dump -u cluster ...`. You can change the username that enables replication mode for `mysqldump` by running `SET GLOBAL cluster_user = new_name`.\n\n  - Use the `-t` flag.\n\n  - When specifying a table in replication mode, you need to follow the `cluster_name:table_name` syntax. For example: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* It's recommended to explicitly specify the `manticore` database when you plan to back up all databases, instead of using the `--all-databases` option.\n\n* Note that `mysqldump` does not support backing up distributed tables and cannot back up tables containing non-stored fields. For such cases, consider using `manticore-backup` or the `BACKUP` SQL command. If you have distributed tables, it is recommended to always specify the tables to be dumped.\n\n<!-- proofread -->",
    "translations": {
      "chinese": "2. 旧的 `manticore.json` 文件必须不存在。\n\n3. 旧的配置文件必须不存在。\n\n4. 旧的数据目录必须存在且为空。\n\n如果满足所有条件，恢复将继续。该工具会提供提示，因此您无需记住它们。避免覆盖现有文件至关重要，因此如果它们仍然存在，请确保在恢复之前将其删除。因此需要满足所有条件。\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## 使用 mysqldump 进行备份和恢复\n\nManticore 支持来自 MySQL 9.5 及以下版本的 `mysqldump` 工具和来自 MariaDB 12.0 及以下版本的 `mariadb-dump` 工具。\n\n<!-- example mysqldump_backup -->\n\n> 注意：某些版本的 `mysqldump` / `mariadb-dump` 需要 [Manticore Buddy](../Installation/Manticore_Buddy.md)。如果转储无法工作，请确保已安装 Buddy。\n\n要创建 Manticore Search 数据库的备份，可以使用 `mysqldump` 命令。示例中将使用默认端口和主机。\n\n注意，`mysqldump` 仅支持实时表。\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\n执行此命令将生成名为 `manticore_backup.sql` 的备份文件。该文件将包含所有数据和表结构。\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\n这将生成一个备份文件 `tbl.sql`，其中使用 `replace` 命令替代 `insert`，每批次保留列名。文档将批量处理，最大大小为16兆字节。不会有 `drop`/`create table` 命令。这对于更改分词设置后进行全文重新索引非常有用。\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\n在这种情况下，`mysqldump` 将生成类似 `REPLACE INTO cluster:table ...` 的命令，这些命令将直接发送到 Manticore 实例，从而重新插入文档。\n\n使用 `cluster` 用户和 `-t` 标志启用复制模式。详情见下方说明。\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### 恢复\n\n如果您想从备份文件恢复 Manticore Search 数据库，mysql 客户端是您的首选工具。\n\n注意，如果您在[纯模式](../Read_this_first.md#Real-time-mode-vs-plain-mode)下恢复，不能直接删除并重建表。因此，您应当：\n\n- 使用带有 `-t` 选项的 `mysqldump`，以排除备份中的 `CREATE TABLE` 语句。\n\n- 在继续恢复之前，手动[清空](../Emptying_a_table.md)表。\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\n此命令允许您从 `manticore_backup.sql` 文件恢复所有内容。\n\n<!-- end -->\n\n### 其他选项\n\n以下是一些可与 mysqldump 一起使用以定制备份的设置：\n\n- `-t` 跳过 `drop`/`create` 表命令。适用于更改分词设置后对表进行全文重新索引。\n\n- `--no-data`：此设置省略表数据，仅备份表结构。\n\n- `--ignore-table=[database_name].[table_name]`：此选项允许您在备份操作中跳过特定表。注意数据库名必须是 `manticore`。\n\n- `--replace` 使用 `replace` 替代 `insert`。适用于更改分词设置后对表进行全文重新索引。\n\n- `--net-buffer-length=16M` 使批处理最大为16兆字节，以加快恢复速度。\n\n- `-e` 批量处理文档。适用于更快恢复。\n\n- `-c` 保留列名。适用于更改表结构（例如更改字段顺序）后重新索引表。\n\n有关设置的完整列表及详细说明，请参阅官方 [MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) 或 [MariaDB 文档](https://mariadb.com/kb/en/mariadb-dump/)。\n\n### 说明\n\n* 要创建复制模式的转储（转储包含 `INSERT/REPLACE INTO <cluster_name>:<table_name>`）：\n\n  - 使用 `cluster` 用户。例如：`mysqldump -u cluster ...` 或 `mariadb-dump -u cluster ...`。您可以通过运行 `SET GLOBAL cluster_user = new_name` 来更改启用 mysqldump 复制模式的用户名。\n\n  - 使用 `-t` 标志。\n\n  - 在复制模式下指定表时，需要遵循 `cluster_name:table_name` 语法。例如：`mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`。\n\n* 建议在计划备份所有数据库时明确指定 `manticore` 数据库，而不是使用 `--all-databases` 选项。\n\n* 注意，`mysqldump` 不支持备份分布式表，也无法备份包含非存储字段的表。对于这种情况，请考虑使用 `manticore-backup` 或 `BACKUP` SQL 命令。如果您有分布式表，建议始终指定要转储的表。\n\n<!-- proofread -->",
      "russian": "2. Старый файл `manticore.json` не должен существовать.\n\n3. Старый конфигурационный файл не должен существовать.\n\n4. Старый каталог данных должен существовать и быть пустым.\n\nЕсли все условия выполнены, восстановление продолжится. Инструмент будет предоставлять подсказки, так что вам не нужно их запоминать. Очень важно не перезаписывать существующие файлы, поэтому убедитесь, что вы удалили их перед восстановлением, если они еще существуют. Отсюда и все условия.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Резервное копирование и восстановление с помощью mysqldump\n\nManticore поддерживает утилиту `mysqldump` из MySQL до версии 9.5 и утилиту `mariadb-dump` из MariaDB до версии 12.0.\n\n<!-- example mysqldump_backup -->\n\n> ПРИМЕЧАНИЕ: некоторые версии `mysqldump` / `mariadb-dump` требуют [Manticore Buddy](../Installation/Manticore_Buddy.md). Если дамп не работает, убедитесь, что Buddy установлен.\n\nДля создания резервной копии вашей базы данных Manticore Search вы можете использовать команду `mysqldump`. В примерах мы будем использовать порт и хост по умолчанию.\n\nОбратите внимание, что `mysqldump` поддерживается только для таблиц реального времени.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nВыполнение этой команды создаст файл резервной копии с именем `manticore_backup.sql`. Этот файл будет содержать все данные и схемы таблиц.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nЭто создаст файл резервной копии `tbl.sql` с командами `replace` вместо `insert`, при этом имена столбцов сохраняются в каждой партии. Документы будут группироваться в партии размером до 16 мегабайт. Команд `drop`/`create table` не будет. Это полезно для полнотекстовой переиндексации после изменения настроек токенизации.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nВ этом случае `mysqldump` сгенерирует команды вида `REPLACE INTO cluster:table ...`, которые будут отправлены напрямую в экземпляр Manticore, что приведет к повторной вставке документов.\n\nИспользуйте пользователя `cluster` и флаг `-t` для включения режима репликации. Подробнее см. в примечаниях ниже.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Восстановление\n\nЕсли вы хотите восстановить базу данных Manticore Search из файла резервной копии, клиент mysql — ваш инструмент выбора.\n\nОбратите внимание, что если вы восстанавливаете в [Plain режиме](../Read_this_first.md#Real-time-mode-vs-plain-mode), вы не можете напрямую удалять и создавать таблицы заново. Поэтому вам следует:\n\n- Использовать `mysqldump` с опцией `-t`, чтобы исключить из резервной копии команды `CREATE TABLE`.\n\n- Вручную [TRUNCATE](../Emptying_a_table.md) таблицы перед продолжением восстановления.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nЭта команда позволяет восстановить всё из файла `manticore_backup.sql`.\n\n<!-- end -->\n\n### Дополнительные опции\n\nВот некоторые дополнительные настройки, которые можно использовать с mysqldump для настройки резервного копирования:\n\n- `-t` пропускает команды `drop`/`create` таблиц. Полезно для полнотекстовой переиндексации таблицы после изменения настроек токенизации.\n\n- `--no-data`: эта настройка исключает данные таблиц из резервной копии, в результате чего файл резервной копии содержит только схемы таблиц.\n\n- `--ignore-table=[database_name].[table_name]`: эта опция позволяет пропустить определённую таблицу во время резервного копирования. Обратите внимание, что имя базы данных должно быть `manticore`.\n\n- `--replace` для выполнения `replace` вместо `insert`. Полезно для полнотекстовой переиндексации таблицы после изменения настроек токенизации.\n\n- `--net-buffer-length=16M` для формирования партий размером до 16 мегабайт для более быстрого восстановления.\n\n- `-e` для пакетной обработки документов. Полезно для более быстрого восстановления.\n\n- `-c` для сохранения имён столбцов. Полезно для переиндексации таблицы после изменения её схемы (например, изменения порядка полей).\n\nДля полного списка настроек и их подробного описания, пожалуйста, обратитесь к официальной [документации MySQL](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) или [документации MariaDB](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Примечания\n\n* Для создания дампа в режиме репликации (когда дамп включает `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Используйте пользователя `cluster`. Например: `mysqldump -u cluster ...` или `mariadb-dump -u cluster ...`. Вы можете изменить имя пользователя, включающего режим репликации для `mysqldump`, выполнив `SET GLOBAL cluster_user = new_name`.\n\n  - Используйте флаг `-t`.\n\n  - При указании таблицы в режиме репликации необходимо использовать синтаксис `cluster_name:table_name`. Например: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* Рекомендуется явно указывать базу данных `manticore`, если вы планируете делать резервную копию всех баз данных, вместо использования опции `--all-databases`.\n\n* Обратите внимание, что `mysqldump` не поддерживает резервное копирование распределённых таблиц и не может создавать резервные копии таблиц, содержащих нестандартные поля. В таких случаях рассмотрите возможность использования `manticore-backup` или SQL-команды `BACKUP`. Если у вас есть распределённые таблицы, рекомендуется всегда явно указывать таблицы для дампа.\n\n<!-- proofread -->"
    },
    "is_code_or_comment": false
  },
  "878c20d3755c4bec02064a91d69dac14ba5a416a9f44623af1adf0f38a6536ff": {
    "original": "# Backup and Restore\n\nBacking up your tables on a regular basis is essential for recovery in the event of system crashes, hardware failure, or data corruption/loss. It's also highly recommended to make backups before upgrading to a new Manticore Search version or running [ALTER TABLE](../Updating_table_schema_and_settings.md#Updating-table-schema-in-RT-mode).\n\nBacking up database systems can be done in two unique ways: logical and physical backups. Each of these methods has its pros and cons, which may vary based on the specific database environment and needs. Here, we'll delve into the distinction between these two types of backups.\n\n### Logical Backups\n\nLogical backups entail exporting the database schema and data as SQL statements or as data formats specific to the database. This backup form is typically readable by humans and can be employed to restore the database on various systems or database engines.\n\nPros and cons of logical backups:\n\n- ➕ **Portability:** Logical backups are generally more portable than physical backups, as they can be used to restore the database on different hardware or operating systems.\n\n- ➕ **Flexibility:** Logical backups allow you to selectively restore specific tables, indexes, or other database objects.\n\n- ➕ **Compatibility:** Logical backups can be used to migrate data between different database management systems or versions, provided the target system supports the exported format or SQL statements.\n\n- ➖ **Slower Backup and Restore:** Logical backups can be slower than physical backups, as they require the database engine to convert the data into SQL statements or another export format.\n\n- ➖ **Increased System Load:** Creating logical backups can cause higher system load, as the process requires more CPU and memory resources to process and export the data.\n\nManticore Search supports [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) for logical backups.\n\n### Physical Backups\n\nPhysical backups involve copying the raw data files and system files that comprise the database. This type of backup essentially creates a snapshot of the database's physical state at a given point in time.\n\nPros and cons of physical backups:\n\n- ➕ **Speed:** Physical backups are usually faster than logical backups, as they involve copying raw data files directly from disk.\n\n- ➕ **Consistency:** Physical backups ensure a consistent backup of the entire database, as all related files are copied together.\n\n- ➕ **Lower System Load:** Creating physical backups generally places less load on the system compared to logical backups, as the process does not involve additional data processing.\n\n- ➖ **Portability:** Physical backups are typically less portable than logical backups, as they may be dependent on the specific hardware, operating system, or database engine configuration.\n\n- ➖ **Flexibility:** Physical backups do not allow for the selective restoration of specific database objects, as the backup contains the entire database's raw files.\n\n- ➖ **Compatibility:** Physical backups cannot be used to migrate data between different database management systems or versions, as the raw data files may not be compatible across different platforms or software.\n\nManticore Search has [manticore-backup](../Securing_and_compacting_a_table/Backup_and_restore.md#Using-manticore-backup-command-line-tool) command line tool for physical backups.\n\nIn summary, logical backups provide more flexibility, portability, and compatibility but can be slower and more resource-intensive, while physical backups are faster, more consistent, and less resource-intensive but may be limited in terms of portability and flexibility. The choice between these two backup methods will depend on your specific database environment, hardware, and requirements.\n\n## Using manticore-backup command line tool\n\nThe `manticore-backup` tool, included in the official Manticore Search [packages](https://manticoresearch.com/install), automates the process of backing up tables for an instance running in [RT mode](../Read_this_first.md#Real-time-mode-vs-plain-mode).\n\n### Installation\n\n**If you followed [the official installation instructions](https://manticoresearch.com/install/), you should already have everything installed and don't need to worry.** Otherwise, [`manticore-backup`](https://github.com/manticoresoftware/manticoresearch-backup) requires PHP 8.1.10 and [specific modules](https://github.com/manticoresoftware/executor/blob/main/build-linux) or [`manticore-executor`](https://github.com/manticoresoftware/executor), which is a part of the `manticore-extra` package, and you need to ensure that one of these is available.\n\nNote that `manticore-backup` is not available for Windows yet.\n\n### How to use\n\nFirst, make sure you're running `manticore-backup` on the same server where the Manticore instance you are about to back up is running.\n\nSecond, we recommend running the tool under the `root` user so the tool can transfer ownership of the files you are backing up. Otherwise, a backup will be also made but with no ownership transfer. In either case, you should make sure that `manticore-backup` has access to the data dir of the Manticore instance.\n\n<!-- example backup1 -->\n\nThe only required argument for `manticore-backup` is `--backup-dir`, which specifies the destination for the backup. If you don't provide any additional arguments, `manticore-backup` will:\n\n- locate a Manticore instance running with the default configuration\n\n- create a subdirectory in the `--backup-dir` directory with a timestamped name\n\n- backup all tables found in the instance\n\n<!-- request Example -->\n\nCODE_BLOCK_0\n\n<!-- response Example -->\n\nCODE_BLOCK_1\n\n<!-- end -->\n\n<!-- example backup2 -->\n\nTo back up specific tables only, use the `--tables` flag followed by a comma-separated list of tables, for example `--tables=tbl1,tbl2`. This will only backup the specified tables and ignore the rest.\n\n<!-- request Example -->\n\nCODE_BLOCK_2\n\n<!-- response Example -->\n\nCODE_BLOCK_3\n\n<!-- end -->\n\n### Arguments\n\n| Argument | Description |\n\n|-|-|",
    "translations": {
      "chinese": "# 备份与恢复\n\n定期备份您的表对于在系统崩溃、硬件故障或数据损坏/丢失时进行恢复至关重要。强烈建议在升级到新的 Manticore Search 版本或运行 [ALTER TABLE](../Updating_table_schema_and_settings.md#Updating-table-schema-in-RT-mode) 之前进行备份。\n\n数据库系统的备份可以通过两种独特的方式完成：逻辑备份和物理备份。这两种方法各有优缺点，具体取决于特定的数据库环境和需求。这里，我们将深入探讨这两种备份类型的区别。\n\n### 逻辑备份\n\n逻辑备份包括将数据库模式和数据导出为 SQL 语句或数据库特定的数据格式。这种备份形式通常是人类可读的，并且可以用于在不同系统或数据库引擎上恢复数据库。\n\n逻辑备份的优缺点：\n\n- ➕ **可移植性：** 逻辑备份通常比物理备份更具可移植性，因为它们可以用于在不同硬件或操作系统上恢复数据库。\n\n- ➕ **灵活性：** 逻辑备份允许您选择性地恢复特定的表、索引或其他数据库对象。\n\n- ➕ **兼容性：** 逻辑备份可用于在不同的数据库管理系统或版本之间迁移数据，前提是目标系统支持导出的格式或 SQL 语句。\n\n- ➖ **备份和恢复速度较慢：** 逻辑备份可能比物理备份慢，因为它们需要数据库引擎将数据转换为 SQL 语句或其他导出格式。\n\n- ➖ **系统负载增加：** 创建逻辑备份可能导致更高的系统负载，因为该过程需要更多的 CPU 和内存资源来处理和导出数据。\n\nManticore Search 支持使用 [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) 进行逻辑备份。\n\n### 物理备份\n\n物理备份涉及复制构成数据库的原始数据文件和系统文件。这种备份类型本质上是在某一时间点创建数据库物理状态的快照。\n\n物理备份的优缺点：\n\n- ➕ **速度：** 物理备份通常比逻辑备份更快，因为它们直接从磁盘复制原始数据文件。\n\n- ➕ **一致性：** 物理备份确保整个数据库的一致备份，因为所有相关文件都会一起复制。\n\n- ➕ **系统负载较低：** 与逻辑备份相比，创建物理备份通常对系统的负载较小，因为该过程不涉及额外的数据处理。\n\n- ➖ **可移植性：** 物理备份通常比逻辑备份的可移植性差，因为它们可能依赖于特定的硬件、操作系统或数据库引擎配置。\n\n- ➖ **灵活性：** 物理备份不允许选择性地恢复特定的数据库对象，因为备份包含整个数据库的原始文件。\n\n- ➖ **兼容性：** 物理备份不能用于在不同的数据库管理系统或版本之间迁移数据，因为原始数据文件可能在不同平台或软件之间不兼容。\n\nManticore Search 提供了用于物理备份的 [manticore-backup](../Securing_and_compacting_a_table/Backup_and_restore.md#Using-manticore-backup-command-line-tool) 命令行工具。\n\n总之，逻辑备份提供了更多的灵活性、可移植性和兼容性，但可能较慢且资源消耗较大；而物理备份速度更快、更一致且资源消耗较少，但在可移植性和灵活性方面可能有限。选择哪种备份方法取决于您的具体数据库环境、硬件和需求。\n\n## 使用 manticore-backup 命令行工具\n\n`manticore-backup` 工具包含在官方 Manticore Search [软件包](https://manticoresearch.com/install)中，自动化了在 [RT 模式](../Read_this_first.md#Real-time-mode-vs-plain-mode) 下运行的实例的表备份过程。\n\n### 安装\n\n**如果您遵循了[官方安装说明](https://manticoresearch.com/install/)，您应该已经安装好所有内容，无需担心。** 否则，[`manticore-backup`](https://github.com/manticoresoftware/manticoresearch-backup) 需要 PHP 8.1.10 和 [特定模块](https://github.com/manticoresoftware/executor/blob/main/build-linux) 或 [`manticore-executor`](https://github.com/manticoresoftware/executor)，后者是 `manticore-extra` 软件包的一部分，您需要确保其中之一可用。\n\n请注意，`manticore-backup` 目前尚不支持 Windows。\n\n### 使用方法\n\n首先，确保您在运行要备份的 Manticore 实例的同一服务器上运行 `manticore-backup`。\n\n其次，建议以 `root` 用户身份运行该工具，以便工具可以转移您备份文件的所有权。否则，备份仍会完成，但不会转移所有权。无论哪种情况，您都应确保 `manticore-backup` 有权访问 Manticore 实例的数据目录。\n\n<!-- example backup1 -->\n\n`manticore-backup` 唯一必需的参数是 `--backup-dir`，它指定备份的目标位置。如果您不提供任何其他参数，`manticore-backup` 将：\n\n- 定位使用默认配置运行的 Manticore 实例\n\n- 在 `--backup-dir` 目录下创建一个带时间戳的子目录\n\n- 备份实例中找到的所有表\n\n<!-- request Example -->\n\nCODE_BLOCK_0\n\n<!-- response Example -->\n\nCODE_BLOCK_1\n\n<!-- end -->\n\n<!-- example backup2 -->\n\n要仅备份特定表，请使用 `--tables` 标志，后跟以逗号分隔的表名列表，例如 `--tables=tbl1,tbl2`。这将只备份指定的表，忽略其余表。\n\n<!-- request Example -->\n\nCODE_BLOCK_2\n\n<!-- response Example -->\n\nCODE_BLOCK_3\n\n<!-- end -->\n\n### 参数\n\n| 参数 | 描述 |\n\n|-|-|",
      "russian": "# Резервное копирование и восстановление\n\nРегулярное резервное копирование ваших таблиц необходимо для восстановления в случае сбоев системы, отказа оборудования или повреждения/потери данных. Также настоятельно рекомендуется создавать резервные копии перед обновлением до новой версии Manticore Search или выполнением [ALTER TABLE](../Updating_table_schema_and_settings.md#Updating-table-schema-in-RT-mode).\n\nРезервное копирование систем баз данных может выполняться двумя уникальными способами: логическим и физическим. Каждый из этих методов имеет свои плюсы и минусы, которые могут варьироваться в зависимости от конкретной среды базы данных и потребностей. Здесь мы рассмотрим различия между этими двумя типами резервных копий.\n\n### Логические резервные копии\n\nЛогические резервные копии предполагают экспорт схемы базы данных и данных в виде SQL-запросов или в форматах данных, специфичных для базы данных. Эта форма резервного копирования обычно читаема человеком и может использоваться для восстановления базы данных на различных системах или движках баз данных.\n\nПлюсы и минусы логических резервных копий:\n\n- ➕ **Портативность:** Логические резервные копии, как правило, более портативны, чем физические, так как их можно использовать для восстановления базы данных на разном оборудовании или операционных системах.\n\n- ➕ **Гибкость:** Логические резервные копии позволяют выборочно восстанавливать конкретные таблицы, индексы или другие объекты базы данных.\n\n- ➕ **Совместимость:** Логические резервные копии можно использовать для миграции данных между разными системами управления базами данных или версиями, при условии, что целевая система поддерживает экспортируемый формат или SQL-запросы.\n\n- ➖ **Медленнее создание и восстановление:** Логические резервные копии могут выполняться медленнее, чем физические, так как движок базы данных должен преобразовать данные в SQL-запросы или другой формат экспорта.\n\n- ➖ **Повышенная нагрузка на систему:** Создание логических резервных копий может вызывать большую нагрузку на систему, так как процесс требует больше ресурсов CPU и памяти для обработки и экспорта данных.\n\nManticore Search поддерживает [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) для логических резервных копий.\n\n### Физические резервные копии\n\nФизические резервные копии включают копирование необработанных файлов данных и системных файлов, составляющих базу данных. Этот тип резервного копирования фактически создает снимок физического состояния базы данных в определенный момент времени.\n\nПлюсы и минусы физических резервных копий:\n\n- ➕ **Скорость:** Физические резервные копии обычно выполняются быстрее логических, так как включают прямое копирование необработанных файлов данных с диска.\n\n- ➕ **Согласованность:** Физические резервные копии обеспечивают согласованное резервное копирование всей базы данных, так как все связанные файлы копируются вместе.\n\n- ➕ **Меньшая нагрузка на систему:** Создание физических резервных копий обычно создает меньшую нагрузку на систему по сравнению с логическими, так как процесс не требует дополнительной обработки данных.\n\n- ➖ **Портативность:** Физические резервные копии, как правило, менее портативны, чем логические, так как могут зависеть от конкретного оборудования, операционной системы или конфигурации движка базы данных.\n\n- ➖ **Гибкость:** Физические резервные копии не позволяют выборочно восстанавливать отдельные объекты базы данных, так как резервная копия содержит необработанные файлы всей базы данных.\n\n- ➖ **Совместимость:** Физические резервные копии нельзя использовать для миграции данных между разными системами управления базами данных или версиями, так как необработанные файлы данных могут быть несовместимы между разными платформами или программным обеспечением.\n\nManticore Search имеет командный инструмент [manticore-backup](../Securing_and_compacting_a_table/Backup_and_restore.md#Using-manticore-backup-command-line-tool) для физических резервных копий.\n\nВ итоге, логические резервные копии обеспечивают большую гибкость, портативность и совместимость, но могут быть медленнее и требовать больше ресурсов, тогда как физические резервные копии быстрее, более согласованы и менее ресурсоемки, но могут иметь ограничения по портативности и гибкости. Выбор между этими двумя методами резервного копирования зависит от вашей конкретной среды базы данных, оборудования и требований.\n\n## Использование командного инструмента manticore-backup\n\nИнструмент `manticore-backup`, включенный в официальные [пакеты](https://manticoresearch.com/install) Manticore Search, автоматизирует процесс резервного копирования таблиц для экземпляра, работающего в [RT режиме](../Read_this_first.md#Real-time-mode-vs-plain-mode).\n\n### Установка\n\n**Если вы следовали [официальным инструкциям по установке](https://manticoresearch.com/install/), у вас уже должно быть все установлено, и вам не о чем беспокоиться.** В противном случае, [`manticore-backup`](https://github.com/manticoresoftware/manticoresearch-backup) требует PHP 8.1.10 и [специфические модули](https://github.com/manticoresoftware/executor/blob/main/build-linux) или [`manticore-executor`](https://github.com/manticoresoftware/executor), который является частью пакета `manticore-extra`, и вам нужно убедиться, что один из них доступен.\n\nОбратите внимание, что `manticore-backup` пока недоступен для Windows.\n\n### Как использовать\n\nВо-первых, убедитесь, что вы запускаете `manticore-backup` на том же сервере, где работает экземпляр Manticore, который вы собираетесь резервировать.\n\nВо-вторых, рекомендуется запускать инструмент под пользователем `root`, чтобы инструмент мог передавать права собственности на файлы, которые вы резервируете. В противном случае резервная копия также будет создана, но без передачи прав собственности. В любом случае, убедитесь, что `manticore-backup` имеет доступ к каталогу данных экземпляра Manticore.\n\n<!-- example backup1 -->\n\nЕдинственным обязательным аргументом для `manticore-backup` является `--backup-dir`, который указывает место назначения для резервной копии. Если вы не укажете дополнительных аргументов, `manticore-backup`:\n\n- найдет экземпляр Manticore, работающий с конфигурацией по умолчанию\n\n- создаст подкаталог в директории `--backup-dir` с именем, содержащим временную метку\n\n- сделает резервную копию всех таблиц, найденных в экземпляре\n\n<!-- request Example -->\n\nCODE_BLOCK_0\n\n<!-- response Example -->\n\nCODE_BLOCK_1\n\n<!-- end -->\n\n<!-- example backup2 -->\n\nЧтобы сделать резервную копию только определенных таблиц, используйте флаг `--tables`, за которым следует список таблиц через запятую, например `--tables=tbl1,tbl2`. Это создаст резервную копию только указанных таблиц, игнорируя остальные.\n\n<!-- request Example -->\n\nCODE_BLOCK_2\n\n<!-- response Example -->\n\nCODE_BLOCK_3\n\n<!-- end -->\n\n### Аргументы\n\n| Аргумент | Описание |\n\n|-|-|"
    },
    "is_code_or_comment": false
  },
  "48bc000842fe3c887c39233e0732db2372882efd46bd817c74f9583e0e1a3555": {
    "original": "| `--backup-dir=path` | This is the path to the backup directory where the backup will be stored. The directory must already exist. This argument is required and has no default value. On each backup run, manticore-backup will create a subdirectory in the provided directory with a timestamp in the name (`backup-[datetime]`), and will copy all required tables to it. So the `--backup-dir` is a container for all your backups, and it's safe to run the script multiple times.|\n\n| `--restore[=backup]` | Restore from `--backup-dir`. Just --restore lists available backups. `--restore=backup` will restore from `<--backup-dir>/backup`. |\n\n| `--force` | Skip versions check on restore and gracefully restore the backup. |\n\n| `--disable-telemetry` | Pass this flag in case you want to disable sending anonymized metrics  to Manticore. You can also use environment variable TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Path to the Manticore configuration. Optional. If not provided, a default configuration for your operating system will be used. Used to determine the host and port for communication with the Manticore daemon. The `manticore-backup` tool supports [dynamic configuration](../Server_settings/Scripted_configuration.md) files. You can specify the `--config` option multiple times if your configuration is spread across multiple files. |\n\n| `--tables=tbl1,tbl2, ...` | Semicolon-separated list of tables that you want to back up. To back up all tables, omit this argument. All the provided tables must exist in the Manticore instance you are backing up from, or the backup will fail. |\n\n| `--compress` | Whether the backed up files should be compressed. Not enabled by default. | optional |\n\n| `--unlock` | In rare cases when something goes wrong, tables can be left in a locked state. Use this argument to unlock them. |\n\n| `--version` | Show the current version. |\n\n| `--help` | Show this help. |\n\n## BACKUP SQL command reference\n\nYou can also back up your data through SQL by running the simple command `BACKUP TO /path/to/backup`.\n\n> NOTE: `BACKUP` is not supported in Windows. Consider using [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) instead.\n\n> NOTE: `BACKUP` requires [Manticore Buddy](../Installation/Manticore_Buddy.md). If it doesn't work, make sure Buddy is installed.\n\n### General syntax of BACKUP\n\nCODE_BLOCK_4\n\nFor instance, to back up tables `a` and `b` to the `/backup` directory, run the following command:\n\nCODE_BLOCK_5\n\nThere are options available to control and adjust the backup process, such as:\n\n* `async`: makes the backup non-blocking, allowing you to receive a response with the backup path immediately and run other queries while the backup is ongoing. The default value is `0`.\n\n* `compress`: enables file compression using zstd. The default value is `0`.\n\nFor example, to run a backup of all tables in async mode with compression enabled to the `/tmp` directory:\n\nCODE_BLOCK_6\n\n### Async backup behavior\n\nWhen using `async = 1` (or `yes`, `on`, `true`), the backup operation runs in a background task:\n\n* The command returns immediately with the backup path\n\n* You can continue running other queries while the backup is in progress\n\n* The backup task runs in a separate thread managed by Manticore Buddy\n\n* While running, the backup task will appear in `SHOW QUERIES` output and will be removed automatically when complete\n\n**Example of async backup:**\n\nCODE_BLOCK_7\n\nThis will return immediately with output like:\n\nCODE_BLOCK_8\n\nYou can check if the backup is still running by using `SHOW QUERIES`. Once complete, the task will disappear from the queries list and all backup files will be present in the specified directory.\n\n### Important considerations\n\n1. The backup path can contain spaces if enclosed in single quotes, e.g., `BACKUP TO '/path/with spaces'`\n\n2. Paths without spaces don't require quotes: `BACKUP TO /tmp/backup`\n\n3. Windows paths are supported: `BACKUP TO 'C:\\path'` or `BACKUP TO C:\\windows\\backup`\n\n4. Ensure that Manticore Buddy is launched (it is by default)\n\n5. The backup directory must exist and be writable by the Manticore process\n\n### How backup maintains consistency of tables\n\nTo ensure consistency of tables during backup, Manticore Search's backup tools use the innovative [FREEZE and UNFREEZE](../Securing_and_compacting_a_table/Freezing_a_table.md) commands. Unlike the traditional lock and unlock tables feature of e.g. MySQL, `FREEZE` stops flushing data to disk while still permitting writing (to some extent) and selecting updated data from the table.\n\nHowever, if your RAM chunk size grows beyond the `rt_mem_limit` threshold during lengthy backup operations involving many inserts, data may be flushed to disk, and write operations will be blocked until flushing is complete. Despite this, the tool maintains a balance between table locking, data consistency, and database write availability while the table is frozen.\n\nWhen you use `manticore-backup` or the SQL `BACKUP` command, the `FREEZE` command is executed once and freezes all tables you are backing up simultaneously. The backup process subsequently backs up each table one by one, releasing the freeze after successfully backing up each table.\n\nIf backup fails or gets interrupted, the tool tries to unfreeze all the tables.\n\n## Restore by using manticore-backup tool\n\n<!-- example restore_list -->\n\nTo restore a Manticore instance from a backup, use the `manticore-backup` command with the `--backup-dir` and `--restore` arguments. For example: `manticore-backup --backup-dir=/path/to/backups --restore`. If you don't provide any argument for `--restore`, it will simply list all the backups in the `--backup-dir`.\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\nTo start a restore job, run `manticore-backup` with the flag `--restore=backup name`, where `backup name` is the name of the backup directory within the `--backup-dir`. Note that:\n\n1. There can't be any Manticore instance running on the same host and port as the one being restored.",
    "translations": {
      "chinese": "| `--backup-dir=path` | 这是备份目录的路径，备份将存储在该目录中。该目录必须已存在。此参数是必需的且没有默认值。每次备份运行时，manticore-backup 会在提供的目录中创建一个带有时间戳的子目录（`backup-[datetime]`），并将所有所需的表复制到该子目录中。因此，`--backup-dir` 是所有备份的容器，运行脚本多次是安全的。|\n\n| `--restore[=backup]` | 从 `--backup-dir` 恢复。仅使用 --restore 会列出可用的备份。`--restore=backup` 将从 `<--backup-dir>/backup` 恢复。 |\n\n| `--force` | 在恢复时跳过版本检查并优雅地恢复备份。 |\n\n| `--disable-telemetry` | 如果您想禁用向 Manticore 发送匿名指标，请传递此标志。您也可以使用环境变量 TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Manticore 配置的路径。可选。如果未提供，将使用适合您操作系统的默认配置。用于确定与 Manticore 守护进程通信的主机和端口。`manticore-backup` 工具支持[动态配置](../Server_settings/Scripted_configuration.md)文件。如果您的配置分布在多个文件中，可以多次指定 `--config` 选项。 |\n\n| `--tables=tbl1,tbl2, ...` | 您想备份的表的分号分隔列表。要备份所有表，请省略此参数。所有提供的表必须存在于您备份的 Manticore 实例中，否则备份将失败。 |\n\n| `--compress` | 是否对备份的文件进行压缩。默认未启用。| 可选 |\n\n| `--unlock` | 在极少数情况下，当出现问题时，表可能会处于锁定状态。使用此参数解锁它们。 |\n\n| `--version` | 显示当前版本。 |\n\n| `--help` | 显示此帮助信息。 |\n\n## BACKUP SQL 命令参考\n\n您也可以通过运行简单命令 `BACKUP TO /path/to/backup` 来备份数据。\n\n> 注意：`BACKUP` 不支持 Windows。请考虑使用 [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) 替代。\n\n> 注意：`BACKUP` 需要 [Manticore Buddy](../Installation/Manticore_Buddy.md)。如果无法使用，请确保 Buddy 已安装。\n\n### BACKUP 的通用语法\n\nCODE_BLOCK_4\n\n例如，要将表 `a` 和 `b` 备份到 `/backup` 目录，运行以下命令：\n\nCODE_BLOCK_5\n\n有一些选项可用于控制和调整备份过程，例如：\n\n* `async`：使备份非阻塞，允许您立即收到带有备份路径的响应，并在备份进行时运行其他查询。默认值为 `0`。\n\n* `compress`：启用使用 zstd 的文件压缩。默认值为 `0`。\n\n例如，要以异步模式运行所有表的备份，并启用压缩到 `/tmp` 目录：\n\nCODE_BLOCK_6\n\n### 异步备份行为\n\n使用 `async = 1`（或 `yes`、`on`、`true`）时，备份操作在后台任务中运行：\n\n* 命令立即返回备份路径\n\n* 您可以在备份进行时继续运行其他查询\n\n* 备份任务在由 Manticore Buddy 管理的单独线程中运行\n\n* 运行时，备份任务会出现在 `SHOW QUERIES` 输出中，完成后会自动移除\n\n**异步备份示例：**\n\nCODE_BLOCK_7\n\n这将立即返回类似如下的输出：\n\nCODE_BLOCK_8\n\n您可以使用 `SHOW QUERIES` 检查备份是否仍在运行。完成后，任务将从查询列表中消失，所有备份文件将存在于指定目录中。\n\n### 重要注意事项\n\n1. 如果路径中包含空格，可以用单引号括起来，例如 `BACKUP TO '/path/with spaces'`\n\n2. 不含空格的路径无需引号：`BACKUP TO /tmp/backup`\n\n3. 支持 Windows 路径：`BACKUP TO 'C:\\path'` 或 `BACKUP TO C:\\windows\\backup`\n\n4. 确保已启动 Manticore Buddy（默认启动）\n\n5. 备份目录必须存在且 Manticore 进程有写权限\n\n### 备份如何保持表的一致性\n\n为了确保备份期间表的一致性，Manticore Search 的备份工具使用了创新的 [FREEZE 和 UNFREEZE](../Securing_and_compacting_a_table/Freezing_a_table.md) 命令。与例如 MySQL 的传统锁定和解锁表功能不同，`FREEZE` 会停止将数据刷新到磁盘，同时仍允许一定程度的写入和从表中选择更新的数据。\n\n然而，如果在涉及大量插入的长时间备份操作中，您的 RAM 块大小超过了 `rt_mem_limit` 阈值，数据可能会被刷新到磁盘，写操作将被阻塞直到刷新完成。尽管如此，该工具在表冻结期间保持了表锁定、数据一致性和数据库写入可用性之间的平衡。\n\n当您使用 `manticore-backup` 或 SQL `BACKUP` 命令时，`FREEZE` 命令会执行一次，并同时冻结所有您正在备份的表。备份过程随后逐个备份每个表，成功备份后释放冻结。\n\n如果备份失败或中断，工具会尝试解冻所有表。\n\n## 使用 manticore-backup 工具恢复\n\n<!-- example restore_list -->\n\n要从备份恢复 Manticore 实例，请使用带有 `--backup-dir` 和 `--restore` 参数的 `manticore-backup` 命令。例如：`manticore-backup --backup-dir=/path/to/backups --restore`。如果您未为 `--restore` 提供任何参数，它将仅列出 `--backup-dir` 中的所有备份。\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\n要开始恢复任务，运行带有 `--restore=backup name` 标志的 `manticore-backup`，其中 `backup name` 是 `--backup-dir` 中备份目录的名称。请注意：\n\n1. 恢复时，不能有任何 Manticore 实例在相同的主机和端口上运行。",
      "russian": "| `--backup-dir=path` | Это путь к каталогу резервного копирования, где будет храниться резервная копия. Каталог должен уже существовать. Этот аргумент обязателен и не имеет значения по умолчанию. При каждом запуске резервного копирования manticore-backup создаст подкаталог в указанном каталоге с отметкой времени в имени (`backup-[datetime]`) и скопирует в него все необходимые таблицы. Таким образом, `--backup-dir` является контейнером для всех ваших резервных копий, и безопасно запускать скрипт несколько раз.|\n\n| `--restore[=backup]` | Восстановление из `--backup-dir`. Просто --restore выводит список доступных резервных копий. `--restore=backup` восстановит из `<--backup-dir>/backup`. |\n\n| `--force` | Пропустить проверку версий при восстановлении и аккуратно восстановить резервную копию. |\n\n| `--disable-telemetry` | Укажите этот флаг, если хотите отключить отправку анонимизированных метрик в Manticore. Также можно использовать переменную окружения TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Путь к конфигурации Manticore. Необязательно. Если не указан, будет использована конфигурация по умолчанию для вашей операционной системы. Используется для определения хоста и порта для связи с демоном Manticore. Инструмент `manticore-backup` поддерживает [динамические конфигурационные](../Server_settings/Scripted_configuration.md) файлы. Вы можете указать опцию `--config` несколько раз, если ваша конфигурация разбита на несколько файлов. |\n\n| `--tables=tbl1,tbl2, ...` | Список таблиц через запятую, которые вы хотите сохранить. Чтобы сохранить все таблицы, опустите этот аргумент. Все указанные таблицы должны существовать в экземпляре Manticore, с которого вы делаете резервное копирование, иначе резервное копирование завершится с ошибкой. |\n\n| `--compress` | Нужно ли сжимать файлы резервной копии. По умолчанию не включено. | необязательно |\n\n| `--unlock` | В редких случаях, когда что-то идет не так, таблицы могут остаться заблокированными. Используйте этот аргумент, чтобы разблокировать их. |\n\n| `--version` | Показать текущую версию. |\n\n| `--help` | Показать эту справку. |\n\n## Справочник по SQL-команде BACKUP\n\nВы также можете сделать резервную копию данных через SQL, выполнив простую команду `BACKUP TO /path/to/backup`.\n\n> ПРИМЕЧАНИЕ: `BACKUP` не поддерживается в Windows. Рассмотрите возможность использования [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) вместо этого.\n\n> ПРИМЕЧАНИЕ: `BACKUP` требует [Manticore Buddy](../Installation/Manticore_Buddy.md). Если не работает, убедитесь, что Buddy установлен.\n\n### Общий синтаксис BACKUP\n\nCODE_BLOCK_4\n\nНапример, чтобы сделать резервную копию таблиц `a` и `b` в каталог `/backup`, выполните следующую команду:\n\nCODE_BLOCK_5\n\nДоступны опции для управления и настройки процесса резервного копирования, такие как:\n\n* `async`: делает резервное копирование неблокирующим, позволяя сразу получить ответ с путем резервной копии и выполнять другие запросы во время выполнения резервного копирования. Значение по умолчанию — `0`.\n\n* `compress`: включает сжатие файлов с помощью zstd. Значение по умолчанию — `0`.\n\nНапример, чтобы выполнить резервное копирование всех таблиц в асинхронном режиме с включенным сжатием в каталог `/tmp`:\n\nCODE_BLOCK_6\n\n### Поведение асинхронного резервного копирования\n\nПри использовании `async = 1` (или `yes`, `on`, `true`) операция резервного копирования выполняется в фоновом задании:\n\n* Команда возвращает управление сразу с путем резервной копии\n\n* Вы можете продолжать выполнять другие запросы во время выполнения резервного копирования\n\n* Задание резервного копирования выполняется в отдельном потоке, управляемом Manticore Buddy\n\n* Во время выполнения задание резервного копирования будет отображаться в выводе `SHOW QUERIES` и автоматически удалится после завершения\n\n**Пример асинхронного резервного копирования:**\n\nCODE_BLOCK_7\n\nЭто вернет результат сразу, например:\n\nCODE_BLOCK_8\n\nВы можете проверить, выполняется ли резервное копирование, используя `SHOW QUERIES`. После завершения задание исчезнет из списка запросов, и все файлы резервной копии будут присутствовать в указанном каталоге.\n\n### Важные замечания\n\n1. Путь резервной копии может содержать пробелы, если он заключен в одинарные кавычки, например, `BACKUP TO '/path/with spaces'`\n\n2. Пути без пробелов не требуют кавычек: `BACKUP TO /tmp/backup`\n\n3. Поддерживаются пути Windows: `BACKUP TO 'C:\\path'` или `BACKUP TO C:\\windows\\backup`\n\n4. Убедитесь, что Manticore Buddy запущен (по умолчанию он запущен)\n\n5. Каталог резервного копирования должен существовать и быть доступным для записи процессом Manticore\n\n### Как резервное копирование поддерживает согласованность таблиц\n\nДля обеспечения согласованности таблиц во время резервного копирования инструменты резервного копирования Manticore Search используют инновационные команды [FREEZE и UNFREEZE](../Securing_and_compacting_a_table/Freezing_a_table.md). В отличие от традиционной функции блокировки и разблокировки таблиц, например, в MySQL, `FREEZE` останавливает сброс данных на диск, при этом позволяя (в некоторой степени) записывать и выбирать обновленные данные из таблицы.\n\nОднако, если размер RAM-чана превышает порог `rt_mem_limit` во время длительных операций резервного копирования с большим количеством вставок, данные могут быть сброшены на диск, и операции записи будут заблокированы до завершения сброса. Несмотря на это, инструмент поддерживает баланс между блокировкой таблиц, согласованностью данных и доступностью записи в базу данных, пока таблица заморожена.\n\nПри использовании `manticore-backup` или SQL-команды `BACKUP` команда `FREEZE` выполняется один раз и замораживает все таблицы, которые вы резервируете, одновременно. Затем процесс резервного копирования последовательно сохраняет каждую таблицу, снимая заморозку после успешного резервного копирования каждой таблицы.\n\nЕсли резервное копирование не удается или прерывается, инструмент пытается разморозить все таблицы.\n\n## Восстановление с помощью инструмента manticore-backup\n\n<!-- example restore_list -->\n\nДля восстановления экземпляра Manticore из резервной копии используйте команду `manticore-backup` с аргументами `--backup-dir` и `--restore`. Например: `manticore-backup --backup-dir=/path/to/backups --restore`. Если не указать аргумент для `--restore`, будет просто выведен список всех резервных копий в `--backup-dir`.\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\nЧтобы начать задачу восстановления, запустите `manticore-backup` с флагом `--restore=backup name`, где `backup name` — имя каталога резервной копии внутри `--backup-dir`. Обратите внимание, что:\n\n1. На том же хосте и порту не должно быть запущено ни одного экземпляра Manticore, который восстанавливается."
    },
    "is_code_or_comment": false
  },
  "410c6bc58096a9fc107be36856210020865725612f0a30fa6acf8b66b22a9175": {
    "original": "2. The old `manticore.json` file must not exist.\n\n3. The old configuration file must not exist.\n\n4. The old data directory must exist and be empty.\n\nIf all conditions are met, the restore will proceed. The tool will provide hints, so you don't have to memorize them. It's crucial to avoid overwriting existing files, so make sure to remove them prior to the restore if they still exist. Hence all the conditions.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Backup and restore with mysqldump\n\nManticore supports `mysqldump` utility from MySQL up to 9.5 and `mariadb-dump` utility from MariaDB up to 12.0.\n\n<!-- example mysqldump_backup -->\n\n> NOTE: some versions of `mysqldump` / `mariadb-dump` require [Manticore Buddy](../Installation/Manticore_Buddy.md). If the dump isn't working, make sure Buddy is installed.\n\nTo create a backup of your Manticore Search database, you can use the `mysqldump` command. We will use the default port and host in the examples.\n\nNote, `mysqldump` is supported only for real-time tables.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nExecuting this command will produce a backup file named `manticore_backup.sql`. This file will hold all data and table schemas.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nThis will produce a backup file `tbl.sql` with `replace` commands instead of `insert`, with column names retained in each batch. Documents will be batched up to 16 megabytes large. There will be no `drop`/`create table` commands. This is useful for full-text reindexation after changing tokenization settings.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nIn this case, `mysqldump` will generate commands like `REPLACE INTO cluster:table ...`, which will be sent directly to the Manticore instance, resulting in the documents being reinserted.\n\nUse the `cluster` user and the `-t` flag to enable replication mode. See the details in the notes below.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Restore\n\nIf you're looking to restore a Manticore Search database from a backup file, the mysql client is your tool of choice.\n\nNote, if you are restoring in [Plain mode](../Read_this_first.md#Real-time-mode-vs-plain-mode), you cannot drop and recreate tables directly. Therefore, you should:\n\n- Use `mysqldump` with the `-t` option to exclude `CREATE TABLE` statements from your backup.\n\n- Manually [TRUNCATE](../Emptying_a_table.md) the tables before proceeding with the restoration.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nThis command enables you to restore everything from the `manticore_backup.sql` file.\n\n<!-- end -->\n\n### Additional options\n\nHere are some more settings that can be used with mysqldump to tailor your backup:\n\n- `-t` skips `drop`/`create` table commands. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--no-data`: This setting omits table data from the backup, resulting in a backup file that consists only of table schemas.\n\n- `--ignore-table=[database_name].[table_name]`: This option allows you to bypass a particular table during the backup operation. Note that the database name must be `manticore`.\n\n- `--replace` to perform `replace` instead of `insert`. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--net-buffer-length=16M` to make batches up to 16 megabytes large for faster restoration.\n\n- `-e` to batch up documents. Useful for faster restoration.\n\n- `-c` to keep column names. Useful for reindexation of a table after changing its schema (e.g., changing field order).\n\nFor a comprehensive list of settings and their thorough descriptions, kindly refer to the official [MySQL documentation](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) or [MariaDB documentation](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Notes\n\n* To create a dump in replication mode (where the dump includes `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Make sure the table isn't changed while it's being dumped.\n\n  - Use the `cluster` user. For example: `mysqldump -u cluster ...` or `mariadb-dump -u cluster ...`. You can change the username that enables replication mode for `mysqldump` by running `SET GLOBAL cluster_user = new_name`.\n\n  - Use the `-t` flag.\n\n  - Use the `--skip-lock-tables` flag.\n\n  - When specifying a table in replication mode, you need to follow the `cluster_name:table_name` syntax. For example: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* It's recommended to explicitly specify the `manticore` database when you plan to back up all databases, instead of using the `--all-databases` option.\n\n* Note that `mysqldump` does not support backing up distributed tables and cannot back up tables containing non-stored fields. For such cases, consider using `manticore-backup` or the `BACKUP` SQL command. If you have distributed tables, it is recommended to always specify the tables to be dumped.\n\n<!-- proofread -->",
    "translations": {
      "chinese": "2. 旧的 `manticore.json` 文件必须不存在。\n\n3. 旧的配置文件必须不存在。\n\n4. 旧的数据目录必须存在且为空。\n\n如果满足所有条件，恢复将继续。该工具会提供提示，因此您无需记住它们。避免覆盖现有文件至关重要，因此如果它们仍然存在，请确保在恢复之前将其删除。因此需要满足所有条件。\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## 使用 mysqldump 进行备份和恢复\n\nManticore 支持来自 MySQL 9.5 及以下版本的 `mysqldump` 工具和来自 MariaDB 12.0 及以下版本的 `mariadb-dump` 工具。\n\n<!-- example mysqldump_backup -->\n\n> 注意：某些版本的 `mysqldump` / `mariadb-dump` 需要 [Manticore Buddy](../Installation/Manticore_Buddy.md)。如果转储无法工作，请确保已安装 Buddy。\n\n要创建 Manticore Search 数据库的备份，可以使用 `mysqldump` 命令。示例中将使用默认端口和主机。\n\n注意，`mysqldump` 仅支持实时表。\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\n执行此命令将生成名为 `manticore_backup.sql` 的备份文件。该文件将包含所有数据和表结构。\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\n这将生成一个备份文件 `tbl.sql`，其中使用 `replace` 命令替代 `insert`，并在每个批次中保留列名。文档将批量处理，最大大小为16兆字节。不会有 `drop`/`create table` 命令。这对于更改分词设置后进行全文重新索引非常有用。\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\n在这种情况下，`mysqldump` 将生成类似 `REPLACE INTO cluster:table ...` 的命令，这些命令将直接发送到 Manticore 实例，从而重新插入文档。\n\n使用 `cluster` 用户和 `-t` 标志以启用复制模式。详情见下方注释。\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### 恢复\n\n如果您想从备份文件恢复 Manticore Search 数据库，mysql 客户端是您的首选工具。\n\n注意，如果您在[纯模式](../Read_this_first.md#Real-time-mode-vs-plain-mode)下恢复，不能直接删除并重新创建表。因此，您应该：\n\n- 使用带有 `-t` 选项的 `mysqldump`，以排除备份中的 `CREATE TABLE` 语句。\n\n- 在继续恢复之前，手动[清空](../Emptying_a_table.md)表。\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\n此命令允许您从 `manticore_backup.sql` 文件恢复所有内容。\n\n<!-- end -->\n\n### 其他选项\n\n以下是一些可与 mysqldump 一起使用以定制备份的设置：\n\n- `-t` 跳过 `drop`/`create` 表命令。适用于更改分词设置后对表进行全文重新索引。\n\n- `--no-data`：此设置会省略备份中的表数据，生成仅包含表结构的备份文件。\n\n- `--ignore-table=[database_name].[table_name]`：此选项允许您在备份操作中跳过特定表。注意数据库名必须是 `manticore`。\n\n- `--replace` 执行 `replace` 替代 `insert`。适用于更改分词设置后对表进行全文重新索引。\n\n- `--net-buffer-length=16M` 使批次最大为16兆字节，以加快恢复速度。\n\n- `-e` 批量处理文档。适用于更快恢复。\n\n- `-c` 保留列名。适用于更改表结构（例如更改字段顺序）后重新索引表。\n\n有关设置的完整列表及详细说明，请参阅官方 [MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) 或 [MariaDB 文档](https://mariadb.com/kb/en/mariadb-dump/)。\n\n### 注释\n\n* 要创建复制模式下的转储（转储包含 `INSERT/REPLACE INTO <cluster_name>:<table_name>`）：\n\n  - 确保转储时表未被更改。\n\n  - 使用 `cluster` 用户。例如：`mysqldump -u cluster ...` 或 `mariadb-dump -u cluster ...`。您可以通过运行 `SET GLOBAL cluster_user = new_name` 来更改启用 mysqldump 复制模式的用户名。\n\n  - 使用 `-t` 标志。\n\n  - 使用 `--skip-lock-tables` 标志。\n\n  - 在复制模式下指定表时，需要遵循 `cluster_name:table_name` 语法。例如：`mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`。\n\n* 建议在计划备份所有数据库时明确指定 `manticore` 数据库，而不是使用 `--all-databases` 选项。\n\n* 注意，`mysqldump` 不支持备份分布式表，也无法备份包含非存储字段的表。对于这种情况，请考虑使用 `manticore-backup` 或 `BACKUP` SQL 命令。如果您有分布式表，建议始终指定要转储的表。\n\n<!-- proofread -->",
      "russian": "2. Старый файл `manticore.json` не должен существовать.\n\n3. Старый конфигурационный файл не должен существовать.\n\n4. Старый каталог данных должен существовать и быть пустым.\n\nЕсли все условия выполнены, восстановление продолжится. Инструмент будет предоставлять подсказки, так что вам не нужно их запоминать. Очень важно избежать перезаписи существующих файлов, поэтому убедитесь, что вы удалили их перед восстановлением, если они еще существуют. Отсюда и все условия.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Резервное копирование и восстановление с помощью mysqldump\n\nManticore поддерживает утилиту `mysqldump` из MySQL до версии 9.5 и утилиту `mariadb-dump` из MariaDB до версии 12.0.\n\n<!-- example mysqldump_backup -->\n\n> ПРИМЕЧАНИЕ: некоторые версии `mysqldump` / `mariadb-dump` требуют [Manticore Buddy](../Installation/Manticore_Buddy.md). Если дамп не работает, убедитесь, что Buddy установлен.\n\nДля создания резервной копии вашей базы данных Manticore Search вы можете использовать команду `mysqldump`. В примерах мы будем использовать порт и хост по умолчанию.\n\nОбратите внимание, что `mysqldump` поддерживается только для таблиц реального времени.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nВыполнение этой команды создаст файл резервной копии с именем `manticore_backup.sql`. Этот файл будет содержать все данные и схемы таблиц.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nЭто создаст файл резервной копии `tbl.sql` с командами `replace` вместо `insert`, при этом имена столбцов сохраняются в каждой партии. Документы будут группироваться в пакеты размером до 16 мегабайт. Команд `drop`/`create table` не будет. Это полезно для полнотекстовой переиндексации после изменения настроек токенизации.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nВ этом случае `mysqldump` сгенерирует команды вида `REPLACE INTO cluster:table ...`, которые будут отправлены напрямую в экземпляр Manticore, в результате чего документы будут повторно вставлены.\n\nИспользуйте пользователя `cluster` и флаг `-t` для включения режима репликации. Подробнее см. в примечаниях ниже.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Восстановление\n\nЕсли вы хотите восстановить базу данных Manticore Search из файла резервной копии, клиент mysql — ваш инструмент выбора.\n\nОбратите внимание, что если вы восстанавливаете в [Plain режиме](../Read_this_first.md#Real-time-mode-vs-plain-mode), вы не можете напрямую удалять и создавать таблицы заново. Поэтому вам следует:\n\n- Использовать `mysqldump` с опцией `-t`, чтобы исключить из резервной копии команды `CREATE TABLE`.\n\n- Вручную [TRUNCATE](../Emptying_a_table.md) таблицы перед продолжением восстановления.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nЭта команда позволяет восстановить всё из файла `manticore_backup.sql`.\n\n<!-- end -->\n\n### Дополнительные опции\n\nВот некоторые дополнительные настройки, которые можно использовать с mysqldump для настройки резервного копирования:\n\n- `-t` пропускает команды `drop`/`create` таблиц. Полезно для полнотекстовой переиндексации таблицы после изменения настроек токенизации.\n\n- `--no-data`: эта настройка исключает данные таблиц из резервной копии, в результате чего файл резервной копии содержит только схемы таблиц.\n\n- `--ignore-table=[database_name].[table_name]`: эта опция позволяет пропустить определённую таблицу во время резервного копирования. Обратите внимание, что имя базы данных должно быть `manticore`.\n\n- `--replace` для выполнения `replace` вместо `insert`. Полезно для полнотекстовой переиндексации таблицы после изменения настроек токенизации.\n\n- `--net-buffer-length=16M` для формирования пакетов размером до 16 мегабайт для более быстрого восстановления.\n\n- `-e` для пакетной обработки документов. Полезно для более быстрого восстановления.\n\n- `-c` для сохранения имён столбцов. Полезно для переиндексации таблицы после изменения её схемы (например, изменения порядка полей).\n\nДля полного списка настроек и их подробного описания, пожалуйста, обратитесь к официальной [документации MySQL](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) или [документации MariaDB](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Примечания\n\n* Чтобы создать дамп в режиме репликации (когда дамп включает `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Убедитесь, что таблица не изменяется во время создания дампа.\n\n  - Используйте пользователя `cluster`. Например: `mysqldump -u cluster ...` или `mariadb-dump -u cluster ...`. Вы можете изменить имя пользователя, включающего режим репликации для `mysqldump`, выполнив `SET GLOBAL cluster_user = new_name`.\n\n  - Используйте флаг `-t`.\n\n  - Используйте флаг `--skip-lock-tables`.\n\n  - При указании таблицы в режиме репликации необходимо использовать синтаксис `cluster_name:table_name`. Например: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* Рекомендуется явно указывать базу данных `manticore`, если вы планируете создавать резервные копии всех баз данных, вместо использования опции `--all-databases`.\n\n* Обратите внимание, что `mysqldump` не поддерживает резервное копирование распределённых таблиц и не может создавать резервные копии таблиц, содержащих нестандартные поля. В таких случаях рассмотрите возможность использования `manticore-backup` или SQL-команды `BACKUP`. Если у вас есть распределённые таблицы, рекомендуется всегда явно указывать таблицы для дампа.\n\n<!-- proofread -->"
    },
    "is_code_or_comment": false
  },
  "232dd760da9171de6486138c836d504ab789669e217a9742cbde0543d3a0009a": {
    "original": "| `--backup-dir=path` | This is the path to the backup directory where the backup will be stored. The directory must already exist. This argument is required and has no default value. On each backup run, manticore-backup will create a subdirectory in the provided directory with a timestamp in the name (`backup-[datetime]`), and will copy all required tables to it. So the `--backup-dir` is a container for all your backups, and it's safe to run the script multiple times.|\n\n| `--restore[=backup]` | Restore from `--backup-dir`. Just --restore lists available backups. `--restore=backup` will restore from `<--backup-dir>/backup`. |\n\n| `--force` | Skip versions check on restore and gracefully restore the backup. |\n\n| `--disable-telemetry` | Pass this flag in case you want to disable sending anonymized metrics  to Manticore. You can also use environment variable TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Path to the Manticore configuration. Optional. If not provided, a default configuration for your operating system will be used. Used to determine the host and port for communication with the Manticore daemon. The `manticore-backup` tool supports [dynamic configuration](../Server_settings/Scripted_configuration.md) files. You can specify the `--config` option multiple times if your configuration is spread across multiple files. |\n\n| `--tables=tbl1,tbl2, ...` | Semicolon-separated list of tables that you want to back up. To back up all tables, omit this argument. All the provided tables must exist in the Manticore instance you are backing up from, or the backup will fail. |\n\n| `--compress` | Whether the backed up files should be compressed. Not enabled by default. | optional |\n\n| `--unlock` | In rare cases when something goes wrong, tables can be left in a locked state. Use this argument to unlock them. |\n\n| `--version` | Show the current version. |\n\n| `--help` | Show this help. |\n\n## BACKUP SQL command reference\n\nYou can also back up your data through SQL by running the simple command `BACKUP TO /path/to/backup`.\n\n> NOTE: `BACKUP` is not supported in Windows. Consider using [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) instead.\n\n> NOTE: `BACKUP` requires [Manticore Buddy](../Installation/Manticore_Buddy.md). If it doesn't work, make sure Buddy is installed.\n\n### General syntax of BACKUP\n\nCODE_BLOCK_4\n\nFor instance, to back up tables `a` and `b` to the `/backup` directory, run the following command:\n\nCODE_BLOCK_5\n\nThere are options available to control and adjust the backup process, such as:\n\n* `async`: makes the backup non-blocking, allowing you to receive a response with the backup path immediately and run other queries while the backup is ongoing. The default value is `0`.\n\n* `compress`: enables file compression using zstd. The default value is `0`.\n\nFor example, to run a backup of all tables in async mode with compression enabled to the `/tmp` directory:\n\nCODE_BLOCK_6\n\n### Async backup behavior\n\nWhen using `async = 1` (or `yes`, `on`, `true`), the backup operation runs in a background task:\n\n* The command returns immediately with the backup path\n\n* You can continue running other queries while the backup is in progress\n\n* The backup task runs in a separate thread managed by Manticore Buddy\n\n* While running, the backup task will appear in `SHOW QUERIES` output and will be removed automatically when complete\n\n**Example of async backup:**\n\nCODE_BLOCK_7\n\nThis will return immediately with output like:\n\nCODE_BLOCK_8\n\nYou can check if the backup is still running by using `SHOW QUERIES`. Once complete, the task will disappear from the queries list and all backup files will be present in the specified directory.\n\n### Important considerations\n\n1. The backup path can contain spaces if enclosed in single quotes, e.g., `BACKUP TO '/path/with spaces'`\n\n2. Paths without spaces don't require quotes: `BACKUP TO /tmp/backup`\n\n3. Windows paths are supported: `BACKUP TO 'C:\\path'` or `BACKUP TO C:\\windows\\backup`\n\n4. Ensure that Manticore Buddy is launched (it is by default)\n\n5. The backup directory must exist and be writable by the Manticore process\n\n### How backup maintains consistency of tables\n\nTo ensure consistency of tables during backup, Manticore Search's backup tools use the innovative [FREEZE and UNFREEZE](../Securing_and_compacting_a_table/Freezing_and_locking_a_table.md) commands. Unlike the traditional lock and unlock tables feature of e.g. MySQL, `FREEZE` stops flushing data to disk while still permitting writing (to some extent) and selecting updated data from the table.\n\nHowever, if your RAM chunk size grows beyond the `rt_mem_limit` threshold during lengthy backup operations involving many inserts, data may be flushed to disk, and write operations will be blocked until flushing is complete. Despite this, the tool maintains a balance between table locking, data consistency, and database write availability while the table is frozen.\n\nWhen you use `manticore-backup` or the SQL `BACKUP` command, the `FREEZE` command is executed once and freezes all tables you are backing up simultaneously. The backup process subsequently backs up each table one by one, releasing the freeze after successfully backing up each table.\n\nIf backup fails or gets interrupted, the tool tries to unfreeze all the tables.\n\n## Restore by using manticore-backup tool\n\n<!-- example restore_list -->\n\nTo restore a Manticore instance from a backup, use the `manticore-backup` command with the `--backup-dir` and `--restore` arguments. For example: `manticore-backup --backup-dir=/path/to/backups --restore`. If you don't provide any argument for `--restore`, it will simply list all the backups in the `--backup-dir`.\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\nTo start a restore job, run `manticore-backup` with the flag `--restore=backup name`, where `backup name` is the name of the backup directory within the `--backup-dir`. Note that:\n\n1. There can't be any Manticore instance running on the same host and port as the one being restored.",
    "translations": {
      "chinese": "| `--backup-dir=path` | 这是备份目录的路径，备份将存储在该目录中。该目录必须已存在。此参数是必需的且没有默认值。在每次备份运行时，manticore-backup 会在提供的目录中创建一个带有时间戳名称的子目录（`backup-[datetime]`），并将所有所需的表复制到该子目录中。因此，`--backup-dir` 是所有备份的容器，运行脚本多次是安全的。|\n\n| `--restore[=backup]` | 从 `--backup-dir` 恢复。仅使用 --restore 会列出可用的备份。`--restore=backup` 将从 `<--backup-dir>/backup` 恢复。 |\n\n| `--force` | 在恢复时跳过版本检查并优雅地恢复备份。 |\n\n| `--disable-telemetry` | 如果您想禁用向 Manticore 发送匿名指标，请传递此标志。您也可以使用环境变量 TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Manticore 配置的路径。可选。如果未提供，将使用适合您操作系统的默认配置。用于确定与 Manticore 守护进程通信的主机和端口。`manticore-backup` 工具支持[动态配置](../Server_settings/Scripted_configuration.md)文件。如果您的配置分布在多个文件中，可以多次指定 `--config` 选项。 |\n\n| `--tables=tbl1,tbl2, ...` | 您想备份的表的分号分隔列表。要备份所有表，请省略此参数。所有提供的表必须存在于您备份的 Manticore 实例中，否则备份将失败。 |\n\n| `--compress` | 是否对备份的文件进行压缩。默认未启用。| 可选 |\n\n| `--unlock` | 在极少数情况下，当出现问题时，表可能会处于锁定状态。使用此参数解锁它们。 |\n\n| `--version` | 显示当前版本。 |\n\n| `--help` | 显示此帮助信息。 |\n\n## BACKUP SQL 命令参考\n\n您也可以通过运行简单命令 `BACKUP TO /path/to/backup` 来备份数据。\n\n> 注意：`BACKUP` 不支持 Windows。请考虑使用 [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) 替代。\n\n> 注意：`BACKUP` 需要 [Manticore Buddy](../Installation/Manticore_Buddy.md)。如果无法使用，请确保 Buddy 已安装。\n\n### BACKUP 的通用语法\n\nCODE_BLOCK_4\n\n例如，要将表 `a` 和 `b` 备份到 `/backup` 目录，运行以下命令：\n\nCODE_BLOCK_5\n\n有一些选项可用于控制和调整备份过程，例如：\n\n* `async`：使备份非阻塞，允许您立即收到带有备份路径的响应，并在备份进行时运行其他查询。默认值为 `0`。\n\n* `compress`：启用使用 zstd 的文件压缩。默认值为 `0`。\n\n例如，要以异步模式运行所有表的备份，并启用压缩到 `/tmp` 目录：\n\nCODE_BLOCK_6\n\n### 异步备份行为\n\n使用 `async = 1`（或 `yes`、`on`、`true`）时，备份操作在后台任务中运行：\n\n* 命令立即返回备份路径\n\n* 您可以在备份进行时继续运行其他查询\n\n* 备份任务在由 Manticore Buddy 管理的单独线程中运行\n\n* 运行时，备份任务会出现在 `SHOW QUERIES` 输出中，完成后会自动移除\n\n**异步备份示例：**\n\nCODE_BLOCK_7\n\n这将立即返回如下输出：\n\nCODE_BLOCK_8\n\n您可以使用 `SHOW QUERIES` 检查备份是否仍在运行。完成后，任务将从查询列表中消失，所有备份文件将存在于指定目录中。\n\n### 重要注意事项\n\n1. 如果路径包含空格，可以用单引号括起来，例如 `BACKUP TO '/path/with spaces'`\n\n2. 不含空格的路径不需要引号：`BACKUP TO /tmp/backup`\n\n3. 支持 Windows 路径：`BACKUP TO 'C:\\path'` 或 `BACKUP TO C:\\windows\\backup`\n\n4. 确保 Manticore Buddy 已启动（默认启动）\n\n5. 备份目录必须存在且 Manticore 进程有写权限\n\n### 备份如何保持表的一致性\n\n为了确保备份期间表的一致性，Manticore Search 的备份工具使用了创新的 [FREEZE 和 UNFREEZE](../Securing_and_compacting_a_table/Freezing_and_locking_a_table.md) 命令。与例如 MySQL 的传统锁表功能不同，`FREEZE` 会停止将数据刷新到磁盘，同时仍允许一定程度的写入和从表中选择更新的数据。\n\n然而，如果在涉及大量插入的长时间备份操作中，您的 RAM 块大小超过了 `rt_mem_limit` 阈值，数据可能会被刷新到磁盘，写操作将被阻塞直到刷新完成。尽管如此，该工具在表冻结期间保持了表锁定、数据一致性和数据库写入可用性之间的平衡。\n\n当您使用 `manticore-backup` 或 SQL `BACKUP` 命令时，`FREEZE` 命令会执行一次，并同时冻结所有您要备份的表。备份过程随后逐个备份每个表，成功备份后释放冻结。\n\n如果备份失败或中断，工具会尝试解冻所有表。\n\n## 使用 manticore-backup 工具恢复\n\n<!-- example restore_list -->\n\n要从备份恢复 Manticore 实例，请使用带有 `--backup-dir` 和 `--restore` 参数的 `manticore-backup` 命令。例如：`manticore-backup --backup-dir=/path/to/backups --restore`。如果您未为 `--restore` 提供任何参数，它将仅列出 `--backup-dir` 中的所有备份。\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\n要开始恢复任务，运行带有 `--restore=backup name` 标志的 `manticore-backup`，其中 `backup name` 是 `--backup-dir` 中备份目录的名称。请注意：\n\n1. 恢复时，不能有任何 Manticore 实例在相同的主机和端口上运行。",
      "russian": "| `--backup-dir=path` | Это путь к каталогу резервного копирования, где будет храниться резервная копия. Каталог должен уже существовать. Этот аргумент обязателен и не имеет значения по умолчанию. При каждом запуске резервного копирования manticore-backup создаст подкаталог в указанном каталоге с отметкой времени в имени (`backup-[datetime]`) и скопирует в него все необходимые таблицы. Таким образом, `--backup-dir` является контейнером для всех ваших резервных копий, и безопасно запускать скрипт несколько раз.|\n\n| `--restore[=backup]` | Восстановление из `--backup-dir`. Просто --restore выводит список доступных резервных копий. `--restore=backup` восстановит из `<--backup-dir>/backup`. |\n\n| `--force` | Пропустить проверку версий при восстановлении и аккуратно восстановить резервную копию. |\n\n| `--disable-telemetry` | Укажите этот флаг, если хотите отключить отправку анонимизированных метрик в Manticore. Также можно использовать переменную окружения TELEMETRY=0 |\n\n| `--config=/path/to/manticore.conf` | Путь к конфигурации Manticore. Необязательно. Если не указан, будет использована конфигурация по умолчанию для вашей операционной системы. Используется для определения хоста и порта для связи с демоном Manticore. Инструмент `manticore-backup` поддерживает [динамические конфигурационные](../Server_settings/Scripted_configuration.md) файлы. Вы можете указать опцию `--config` несколько раз, если ваша конфигурация разбита на несколько файлов. |\n\n| `--tables=tbl1,tbl2, ...` | Список таблиц, разделённых точкой с запятой, которые вы хотите сохранить. Чтобы сохранить все таблицы, опустите этот аргумент. Все указанные таблицы должны существовать в экземпляре Manticore, с которого вы делаете резервное копирование, иначе резервное копирование завершится с ошибкой. |\n\n| `--compress` | Нужно ли сжимать файлы резервной копии. По умолчанию не включено. | необязательно |\n\n| `--unlock` | В редких случаях, когда что-то идёт не так, таблицы могут остаться заблокированными. Используйте этот аргумент, чтобы разблокировать их. |\n\n| `--version` | Показать текущую версию. |\n\n| `--help` | Показать эту справку. |\n\n## Справочник по SQL-команде BACKUP\n\nВы также можете сделать резервную копию данных через SQL, выполнив простую команду `BACKUP TO /path/to/backup`.\n\n> ПРИМЕЧАНИЕ: `BACKUP` не поддерживается в Windows. Рассмотрите возможность использования [mysqldump](../Securing_and_compacting_a_table/Backup_and_restore.md#Backup-and-restore-with-mysqldump) вместо этого.\n\n> ПРИМЕЧАНИЕ: `BACKUP` требует [Manticore Buddy](../Installation/Manticore_Buddy.md). Если команда не работает, убедитесь, что Buddy установлен.\n\n### Общий синтаксис BACKUP\n\nCODE_BLOCK_4\n\nНапример, чтобы сделать резервную копию таблиц `a` и `b` в каталог `/backup`, выполните следующую команду:\n\nCODE_BLOCK_5\n\nДоступны опции для управления и настройки процесса резервного копирования, такие как:\n\n* `async`: делает резервное копирование неблокирующим, позволяя сразу получить ответ с путем резервной копии и выполнять другие запросы во время выполнения резервного копирования. Значение по умолчанию — `0`.\n\n* `compress`: включает сжатие файлов с помощью zstd. Значение по умолчанию — `0`.\n\nНапример, чтобы выполнить резервное копирование всех таблиц в асинхронном режиме с включённым сжатием в каталог `/tmp`:\n\nCODE_BLOCK_6\n\n### Поведение асинхронного резервного копирования\n\nПри использовании `async = 1` (или `yes`, `on`, `true`) операция резервного копирования выполняется в фоновом задании:\n\n* Команда возвращает управление сразу с путем резервной копии\n\n* Вы можете продолжать выполнять другие запросы во время выполнения резервного копирования\n\n* Задание резервного копирования выполняется в отдельном потоке, управляемом Manticore Buddy\n\n* Во время выполнения задание резервного копирования будет отображаться в выводе `SHOW QUERIES` и автоматически удалится после завершения\n\n**Пример асинхронного резервного копирования:**\n\nCODE_BLOCK_7\n\nЭто вернёт результат сразу с выводом, похожим на:\n\nCODE_BLOCK_8\n\nВы можете проверить, выполняется ли резервное копирование, используя `SHOW QUERIES`. После завершения задание исчезнет из списка запросов, и все файлы резервной копии будут присутствовать в указанном каталоге.\n\n### Важные замечания\n\n1. Путь резервной копии может содержать пробелы, если он заключён в одинарные кавычки, например, `BACKUP TO '/path/with spaces'`\n\n2. Пути без пробелов не требуют кавычек: `BACKUP TO /tmp/backup`\n\n3. Поддерживаются пути Windows: `BACKUP TO 'C:\\path'` или `BACKUP TO C:\\windows\\backup`\n\n4. Убедитесь, что Manticore Buddy запущен (по умолчанию он запущен)\n\n5. Каталог резервного копирования должен существовать и быть доступным для записи процессом Manticore\n\n### Как резервное копирование поддерживает согласованность таблиц\n\nДля обеспечения согласованности таблиц во время резервного копирования инструменты резервного копирования Manticore Search используют инновационные команды [FREEZE и UNFREEZE](../Securing_and_compacting_a_table/Freezing_and_locking_a_table.md). В отличие от традиционной функции блокировки и разблокировки таблиц, например, в MySQL, `FREEZE` останавливает сброс данных на диск, при этом позволяя (в определённой степени) записывать и выбирать обновлённые данные из таблицы.\n\nОднако, если размер RAM-чана превышает порог `rt_mem_limit` во время длительных операций резервного копирования с большим количеством вставок, данные могут быть сброшены на диск, и операции записи будут заблокированы до завершения сброса. Несмотря на это, инструмент поддерживает баланс между блокировкой таблиц, согласованностью данных и доступностью записи в базу данных, пока таблица заморожена.\n\nПри использовании `manticore-backup` или SQL-команды `BACKUP` команда `FREEZE` выполняется один раз и одновременно замораживает все таблицы, которые вы сохраняете. Процесс резервного копирования затем последовательно сохраняет каждую таблицу, снимая заморозку после успешного резервного копирования каждой таблицы.\n\nЕсли резервное копирование не удаётся или прерывается, инструмент пытается разморозить все таблицы.\n\n## Восстановление с помощью инструмента manticore-backup\n\n<!-- example restore_list -->\n\nДля восстановления экземпляра Manticore из резервной копии используйте команду `manticore-backup` с аргументами `--backup-dir` и `--restore`. Например: `manticore-backup --backup-dir=/path/to/backups --restore`. Если не указать аргумент для `--restore`, будет просто выведен список всех резервных копий в `--backup-dir`.\n\n<!-- request Example -->\n\nCODE_BLOCK_9\n\n<!-- response Example -->\n\nCODE_BLOCK_10\n\n<!-- end -->\n\n<!-- example restore -->\n\nЧтобы начать задачу восстановления, запустите `manticore-backup` с флагом `--restore=backup name`, где `backup name` — имя каталога резервной копии внутри `--backup-dir`. Обратите внимание, что:\n\n1. На том же хосте и порту не должно быть запущено ни одного экземпляра Manticore, который восстанавливается."
    },
    "is_code_or_comment": false
  },
  "a41af9d05565072c7e2697bb3beb82b49d8565cc91fe1b826d252ff30bf4d5ec": {
    "original": "2. The old `manticore.json` file must not exist.\n\n3. The old configuration file must not exist.\n\n4. The old data directory must exist and be empty.\n\nIf all conditions are met, the restore will proceed. The tool will provide hints, so you don't have to memorize them. It's crucial to avoid overwriting existing files, so make sure to remove them prior to the restore if they still exist. Hence all the conditions.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Backup and restore with mysqldump\n\nManticore supports `mysqldump` utility from MySQL up to 9.5 and `mariadb-dump` utility from MariaDB up to 12.1.\n\n<!-- example mysqldump_backup -->\n\n> NOTE: some versions of `mysqldump` / `mariadb-dump` require [Manticore Buddy](../Installation/Manticore_Buddy.md). If the dump isn't working, make sure Buddy is installed.\n\nTo create a backup of your Manticore Search database, you can use the `mysqldump` command. We will use the default port and host in the examples.\n\nNote, `mysqldump` is supported only for real-time tables.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nExecuting this command will produce a backup file named `manticore_backup.sql`. This file will hold all data and table schemas.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nThis will produce a backup file `tbl.sql` with `replace` commands instead of `insert`, with column names retained in each batch. Documents will be batched up to 16 megabytes large. There will be no `drop`/`create table` commands. This is useful for full-text reindexation after changing tokenization settings.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nIn this case, `mysqldump` will generate commands like `REPLACE INTO cluster:table ...`, which will be sent directly to the Manticore instance, resulting in the documents being reinserted.\n\nUse the `cluster` user and the `-t` flag to enable replication mode. See the details in the notes below.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Restore\n\nIf you're looking to restore a Manticore Search database from a backup file, the mysql client is your tool of choice.\n\nNote, if you are restoring in [Plain mode](../Read_this_first.md#Real-time-mode-vs-plain-mode), you cannot drop and recreate tables directly. Therefore, you should:\n\n- Use `mysqldump` with the `-t` option to exclude `CREATE TABLE` statements from your backup.\n\n- Manually [TRUNCATE](../Emptying_a_table.md) the tables before proceeding with the restoration.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nThis command enables you to restore everything from the `manticore_backup.sql` file.\n\n<!-- end -->\n\n### Additional options\n\nHere are some more settings that can be used with mysqldump to tailor your backup:\n\n- `-t` skips `drop`/`create` table commands. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--no-data`: This setting omits table data from the backup, resulting in a backup file that consists only of table schemas.\n\n- `--ignore-table=[database_name].[table_name]`: This option allows you to bypass a particular table during the backup operation. Note that the database name must be `manticore`.\n\n- `--replace` to perform `replace` instead of `insert`. Useful for full-text reindexation of a table after changing tokenization settings.\n\n- `--net-buffer-length=16M` to make batches up to 16 megabytes large for faster restoration.\n\n- `-e` to batch up documents. Useful for faster restoration.\n\n- `-c` to keep column names. Useful for reindexation of a table after changing its schema (e.g., changing field order).\n\nFor a comprehensive list of settings and their thorough descriptions, kindly refer to the official [MySQL documentation](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) or [MariaDB documentation](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Notes\n\n* To create a dump in replication mode (where the dump includes `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Make sure the table isn't changed while it's being dumped.\n\n  - Use the `cluster` user. For example: `mysqldump -u cluster ...` or `mariadb-dump -u cluster ...`. You can change the username that enables replication mode for `mysqldump` by running `SET GLOBAL cluster_user = new_name`.\n\n  - Use the `-t` flag.\n\n  - Use the `--skip-lock-tables` flag.\n\n  - When specifying a table in replication mode, you need to follow the `cluster_name:table_name` syntax. For example: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* It's recommended to explicitly specify the `manticore` database when you plan to back up all databases, instead of using the `--all-databases` option.\n\n* Note that `mysqldump` does not support backing up distributed tables and cannot back up tables containing non-stored fields. For such cases, consider using `manticore-backup` or the `BACKUP` SQL command. If you have distributed tables, it is recommended to always specify the tables to be dumped.\n\n<!-- proofread -->",
    "translations": {
      "chinese": "2. 旧的 `manticore.json` 文件必须不存在。\n\n3. 旧的配置文件必须不存在。\n\n4. 旧的数据目录必须存在且为空。\n\n如果所有条件都满足，恢复过程将继续。工具会提供提示，所以你不必记住它们。避免覆盖现有文件至关重要，因此如果它们仍然存在，请确保在恢复之前将其删除。因此有所有这些条件。\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## 使用 mysqldump 进行备份和恢复\n\nManticore 支持来自 MySQL（最高 9.5 版本）的 `mysqldump` 工具和来自 MariaDB（最高 12.1 版本）的 `mariadb-dump` 工具。\n\n<!-- example mysqldump_backup -->\n\n> 注意：某些版本的 `mysqldump` / `mariadb-dump` 需要 [Manticore Buddy](../Installation/Manticore_Buddy.md)。如果导出不工作，请确保 Buddy 已安装。\n\n要创建 Manticore Search 数据库的备份，可以使用 `mysqldump` 命令。示例中我们将使用默认端口和主机。\n\n注意，`mysqldump` 仅支持实时表。\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\n执行此命令将生成名为 `manticore_backup.sql` 的备份文件。该文件将包含所有数据和表结构。\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\n这将生成一个带有 `replace` 命令（而非 `insert`），且每批都保留列名的备份文件 `tbl.sql`。文档将按最大 16 兆字节分批。文件中不会有 `drop` / `create table` 命令。这对更改分词设置后进行全文重新索引非常有用。\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\n在这种情况下，`mysqldump` 将生成类似 `REPLACE INTO cluster:table ...` 的命令，直接发送到 Manticore 实例，从而实现文档的重新插入。\n\n使用 `cluster` 用户和 `-t` 标志启用复制模式。详情见下面的说明。\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### 恢复\n\n如果你想从备份文件恢复 Manticore Search 数据库，mysql 客户端是你的首选工具。\n\n注意，如果你在[普通模式](../Read_this_first.md#Real-time-mode-vs-plain-mode)下恢复，不能直接删除和重建表。因此，你应该：\n\n- 使用带 `-t` 选项的 `mysqldump`，以排除备份中的 `CREATE TABLE` 语句。\n\n- 在恢复之前，手动[清空](../Emptying_a_table.md)表。\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\n此命令使你能够从 `manticore_backup.sql` 文件恢复所有内容。\n\n<!-- end -->\n\n### 其他选项\n\n这里列出了一些可与 mysqldump 一起使用的更多设置，以定制你的备份：\n\n- `-t` 跳过 `drop` / `create` 表命令。对更改分词设置后进行表的全文重新索引很有用。\n\n- `--no-data`：该选项在备份时省略表数据，生成只包含表结构的备份文件。\n\n- `--ignore-table=[database_name].[table_name]`：此选项允许你在备份过程中跳过某个表。注意数据库名称必须是 `manticore`。\n\n- `--replace` 使用 `replace` 替代 `insert`。对更改分词设置后进行表的全文重新索引很有用。\n\n- `--net-buffer-length=16M` 使批次最大为 16 兆字节，加快恢复速度。\n\n- `-e` 进行文档批处理。加快恢复速度。\n\n- `-c` 保留列名。对更改表结构（如字段顺序）后进行重新索引很有用。\n\n欲了解设置的完整列表及详细说明，请参考官方 [MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) 或 [MariaDB 文档](https://mariadb.com/kb/en/mariadb-dump/)。\n\n### 说明\n\n* 若要创建复制模式下的转储（即转储包含 `INSERT/REPLACE INTO <cluster_name>:<table_name>`）：\n\n  - 确保在导出期间表未被更改。\n\n  - 使用 `cluster` 用户。例如：`mysqldump -u cluster ...` 或 `mariadb-dump -u cluster ...`。你可以通过执行 `SET GLOBAL cluster_user = new_name` 来更改启用 mysqldump 复制模式的用户名。\n\n  - 使用 `-t` 标志。\n\n  - 使用 `--skip-lock-tables` 标志。\n\n  - 在复制模式下指定表时，需遵循 `cluster_name:table_name` 语法。例如：`mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`。\n\n* 如果计划备份所有数据库，建议明确指定 `manticore` 数据库，而不是使用 `--all-databases` 选项。\n\n* 注意，`mysqldump` 不支持备份分布式表，也不能备份包含非存储字段的表。此类情况下，建议使用 `manticore-backup` 或 `BACKUP` SQL 命令。如果你有分布式表，建议始终指定具体要转储的表。\n\n<!-- proofread -->",
      "russian": "2. Старый файл `manticore.json` не должен существовать.\n\n3. Старый конфигурационный файл не должен существовать.\n\n4. Старый каталог с данными должен существовать и быть пустым.\n\nЕсли все условия выполнены, восстановление будет продолжено. Инструмент предоставит подсказки, так что вам не нужно их запоминать. Очень важно не перезаписывать существующие файлы, поэтому убедитесь, что вы удалили их перед восстановлением, если они ещё есть. Отсюда и все условия.\n\n<!-- request Example -->\n\nCODE_BLOCK_11\n\n<!-- response Example -->\n\nCODE_BLOCK_12\n\n<!-- end -->\n\n## Резервное копирование и восстановление с помощью mysqldump\n\nManticore поддерживает утилиту `mysqldump` из MySQL до версии 9.5 и утилиту `mariadb-dump` из MariaDB до версии 12.1.\n\n<!-- example mysqldump_backup -->\n\n> ПРИМЕЧАНИЕ: некоторые версии `mysqldump` / `mariadb-dump` требуют [Manticore Buddy](../Installation/Manticore_Buddy.md). Если дамп не работает, убедитесь, что Buddy установлен.\n\nЧтобы создать резервную копию вашей базы данных Manticore Search, можно использовать команду `mysqldump`. В примерах мы используем порт и хост по умолчанию.\n\nОбратите внимание, что `mysqldump` поддерживается только для таблиц реального времени.\n\n<!-- request Basic -->\n\nCODE_BLOCK_13\n\nВыполнение этой команды создаст файл резервной копии с именем `manticore_backup.sql`. Этот файл будет содержать все данные и схемы таблиц.\n\n<!-- request Replace mode -->\n\nCODE_BLOCK_14\n\nЭто создаст файл резервной копии `tbl.sql` с командами `replace` вместо `insert`, при этом имена столбцов сохраняются в каждой партии. Документы будут группироваться партиями до 16 мегабайт. Команд `drop`/`create table` не будет. Это полезно для полной переиндексации текста после изменения настроек токенизации.\n\n<!-- request Replication mode -->\n\nCODE_BLOCK_15\n\nВ этом случае `mysqldump` сгенерирует команды вида `REPLACE INTO cluster:table ...`, которые будут отправлены непосредственно на экземпляр Manticore, что приведёт к повторной вставке документов.\n\nИспользуйте пользователя `cluster` и флаг `-t` для включения режима репликации. Подробнее см. в примечаниях ниже.\n\n<!-- end -->\n\n<!-- example mysqldump_restore -->\n\n### Восстановление\n\nЕсли вы хотите восстановить базу данных Manticore Search из файла резервной копии, инструмент mysql клиент — ваш выбор.\n\nОбратите внимание, что при восстановлении в [Plain режиме](../Read_this_first.md#Real-time-mode-vs-plain-mode) вы не можете напрямую удалять и создавать таблицы. Поэтому следует:\n\n- Использовать `mysqldump` с опцией `-t`, чтобы исключить команды `CREATE TABLE` из вашей резервной копии.\n\n- Вручную выполнить [TRUNCATE](../Emptying_a_table.md) таблиц перед продолжением восстановления.\n\n<!-- request SQL -->\n\nCODE_BLOCK_16\n\nЭта команда позволяет восстановить всё из файла `manticore_backup.sql`.\n\n<!-- end -->\n\n### Дополнительные опции\n\nНиже приведены некоторые настройки, которые можно использовать с mysqldump для настройки вашей резервной копии:\n\n- `-t` пропускает команды `drop`/`create` таблиц. Полезно для полной переиндексации текста таблицы после изменения настроек токенизации.\n\n- `--no-data`: эта опция исключает данные таблиц из резервной копии, в результате получится файл с одними только схемами таблиц.\n\n- `--ignore-table=[database_name].[table_name]`: эта опция позволяет пропустить определённую таблицу во время резервного копирования. Обратите внимание, что имя базы данных должно быть `manticore`.\n\n- `--replace` для выполнения `replace` вместо `insert`. Полезно для полной переиндексации текста таблицы после изменения настроек токенизации.\n\n- `--net-buffer-length=16M` для формирования партий размером до 16 мегабайт, что ускоряет восстановление.\n\n- `-e` для группировки документов пакетами. Полезно для более быстрого восстановления.\n\n- `-c` для сохранения имён столбцов. Полезно для переиндексации таблицы после изменения её схемы (например, изменения порядка полей).\n\nДля полного списка настроек и их подробных описаний, пожалуйста, обратитесь к официальной [документации MySQL](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) или [документации MariaDB](https://mariadb.com/kb/en/mariadb-dump/).\n\n### Примечания\n\n* Чтобы создать дамп в режиме репликации (когда дамп включает `INSERT/REPLACE INTO <cluster_name>:<table_name>`):\n\n  - Убедитесь, что таблица не изменяется во время создания дампа.\n\n  - Используйте пользователя `cluster`. Например: `mysqldump -u cluster ...` или `mariadb-dump -u cluster ...`. Вы можете изменить имя пользователя, включающего режим репликации для `mysqldump`, выполнив `SET GLOBAL cluster_user = new_name`.\n\n  - Используйте флаг `-t`.\n\n  - Используйте флаг `--skip-lock-tables`.\n\n  - При указании таблицы в режиме репликации необходимо следовать синтаксису `cluster_name:table_name`. Например: `mysqldump -P9306 -h0 -t -ucluster manticore cluster:tbl`.\n\n* Рекомендуется явно указывать базу данных `manticore`, если вы планируете делать резервное копирование всех баз, вместо использования опции `--all-databases`.\n\n* Обратите внимание, что `mysqldump` не поддерживает резервное копирование распределённых таблиц и не может резервировать таблицы с нестинаряемыми (non-stored) полями. В таких случаях используйте `manticore-backup` или SQL команду `BACKUP`. Если у вас есть распределённые таблицы, рекомендуется всегда указывать конкретные таблицы для дампа.\n\n<!-- proofread -->"
    },
    "is_code_or_comment": false
  }
}
