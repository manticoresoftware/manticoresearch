# टोकन फ़िल्टर प्लगइन

टोकन फ़िल्टर प्लगइन आपको कस्टम नियमों के अनुसार टोकन बनाने वाले एक कस्टम टोकनाइज़र को लागू करने की अनुमति देते हैं। इसके दो प्रकार हैं:

* इंडेक्स-समय टोकनाइज़र जिसे [index_token_filter](../../../Creating_a_table/NLP_and_tokenization/Low-level_tokenization.md#index_token_filter) में तालिका सेटिंग्स में घोषित किया गया है
* क्वेरी-समय टोकनाइज़र जिसे [token_filter](../../../Searching/Options.md#token_filter) OPTION निर्देश में घोषित किया गया है

टेक्स्ट प्रसंस्करण पाइपलाइन में, टोकन फ़िल्टर बेस टोकनाइज़र प्रसंस्करण के होने के बाद चलेंगे (जो फ़ील्ड या क्वेरी से टेक्स्ट को संसाधित करता है और उनसे टोकन बनाता है)।

## इंडेक्स-समय टोकनाइज़र

इंडेक्स-समय टोकनाइज़र `indexer` द्वारा टेबल में स्रोत डेटा को अनुक्रमित करते समय या `INSERT` या `REPLACE` कथनों को संसाधित करते समय एक RT तालिका द्वारा बनाया जाता है।

प्लगइन को `पुस्तकालय नाम:प्लगइन नाम:वैकल्पिक सेटिंग्स की स्ट्रिंग` के रूप में घोषणित किया जाता है। प्लगइन के इनिट फ़ंक्शन मनमाने सेटिंग्स को स्वीकार कर सकते हैं जो `option1=value1;option2=value2;..` प्रारूप में एक स्ट्रिंग के रूप में दी जा सकती हैं।

उदाहरण:

```ini
index_token_filter = my_lib.so:email_process:field=email;split=.io
```

इंडेक्स-समय टोकन फ़िल्टर के लिए कॉल कार्यप्रवाह इस प्रकार है:

1.  `XXX_init()` को `indexer` द्वारा खाली फ़ील्ड सूची के साथ टोकन फ़िल्टर बनाने के तुरंत बाद कॉल किया जाता है और फिर जब `indexer` वास्तविक फ़ील्ड सूची के साथ तालिका स्कीमा प्राप्त करता है। इसे सफलतापूर्वक इनिशियलाइजेशन के लिए शून्य लौटाना चाहिए, अन्यथा एक त्रुटि वर्णन।
2.  `XXX_begin_document` केवल RT तालिका `INSERT`/`REPLACE` के लिए हर दस्तावेज़ के लिए कॉल किया जाता है। इसे सफल कॉल के लिए शून्य लौटाना चाहिए, अन्यथा एक त्रुटि वर्णन। OPTION `token_filter_options` का उपयोग करके, अतिरिक्त पैरामीटर/सेटिंग्स को फ़ंक्शन में पास किया जा सकता है।
    ```sql
    INSERT INTO rt (id, title) VALUES (1, 'some text corp@space.io') OPTION token_filter_options='.io'
    ```
3.  `XXX_begin_field` बेस टोकनाइज़र के साथ फ़ील्ड को संसाधित करने से पहले प्रत्येक फ़ील्ड के लिए एक बार कॉल किया जाता है, फ़ील्ड संख्या इसके पैरामीटर के रूप में।
4.  `XXX_push_token` बेस टोकनाइज़र द्वारा उत्पन्न प्रत्येक नए टोकन के लिए एक बार कॉल किया जाता है, स्रोत टोकन इसके पैरामीटर के रूप में। इसे टोकन, टोकन फ़िल्टर द्वारा बनाए गए अतिरिक्त टोकनों की संख्या, और टोकन के लिए डेल्टा स्थिति लौटानी चाहिए।
5.  `XXX_get_extra_token` को कई बार कॉल किया जाता है यदि `XXX_push_token` अतिरिक्त टोकन की रिपोर्ट करता है। इसे टोकन और उस अतिरिक्त टोकन के लिए डेल्टा स्थिति लौटानी चाहिए।
6.  `XXX_end_field` को वर्तमान फ़ील्ड से स्रोत टोकन संसाधित होने के तुरंत बाद एक बार कॉल किया जाता है।
7.  `XXX_deinit` को अनुक्रमण के अंत में बिल्कुल कॉल किया जाता है।

निम्नलिखित फ़ंक्शन को परिभाषित करना अनिवार्य है: `XXX_begin_document`, `XXX_push_token`, और `XXX_get_extra_token`।

## क्वेरी-समय टोकन फ़िल्टर

क्वेरी-समय टोकनाइज़र हर बार खोज पर बनाया जाता है जब पूर्ण-टेक्स्ट किसी भी संबंधित तालिका द्वारा बुलाया जाता है।

क्वेरी-समय टोकन फ़िल्टर के लिए कॉल कार्यप्रवाह इस प्रकार है:

1.  `XXX_init()` को पैरामीटर के साथ क्वेरी का पार्स करने से पहले प्रत्येक तालिका के लिए एक बार कॉल किया जाता है - अधिकतम टोकन लंबाई और एक स्ट्रिंग जो `token_filter` विकल्प द्वारा सेट की गई है
    ```sql
    SELECT * FROM index WHERE MATCH ('test') OPTION token_filter='my_lib.so:query_email_process:io'
    ```
    इसे सफलतापूर्वक इनिशियलाइजेशन के लिए शून्य लौटाना चाहिए, अन्यथा त्रुटि वर्णन।
2.  `XXX_push_token()` बेस टोकनाइज़र द्वारा उत्पन्न प्रत्येक नए टोकन के लिए एक बार कॉल किया जाता है, इसके पैरामीटर: बेस टोकनाइज़र द्वारा उत्पन्न टोकन, स्रोत क्वेरी स्ट्रिंग में कच्चे टोकन का पॉइंटर, और कच्चे टोकन की लंबाई। इसे टोकन और टोकन के लिए डेल्टा स्थिति लौटानी चाहिए।
3.  `XXX_pre_morph()` को टोकन के लिए एक बार कॉल किया जाता है ठीक इससे पहले कि इसे रूपविज्ञान प्रोसेसर को पास किया जाए, एक संदर्भ के साथ टोकन और स्टॉपवर्ड फ्लैग। यह टोकन को स्टॉपवर्ड के रूप में चिह्नित करने के लिए स्टॉपवर्ड फ्लैग सेट कर सकता है।
4.  `XXX_post_morph()` को टोकन के लिए एक बार कॉल किया जाता है उसके बाद जब इसे रूपविज्ञान प्रोसेसर द्वारा संसाधित किया जाता है, एक संदर्भ के साथ टोकन और स्टॉपवर्ड फ्लैग। यह टोकन को स्टॉपवर्ड के रूप में चिह्नित करने के लिए स्टॉपवर्ड फ्लैग सेट कर सकता है। इसे एक फ्लैग लौटाना चाहिए, जिसका गैर-शून्य मान अर्थ है कि इसे रूपविज्ञान प्रसंस्करण से पहले टोकन का उपयोग करने के लिए।
5.  `XXX_deinit()` को क्वेरी प्रसंस्करण के अंत में बिल्कुल कॉल किया जाता है।

फ़ंक्शनों की अनुपस्थिति को सहन किया जाता है।

<!-- proofread -->
