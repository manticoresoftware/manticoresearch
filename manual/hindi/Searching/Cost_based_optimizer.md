# लागत-आधारित ऑप्टिमाइज़र


जब मैन्टिकोर एक पूर्णस्कैन प्रश्न निष्पादित करता है, तो वह फ़िल्टर के खिलाफ प्रत्येक दस्तावेज़ की जाँच करने के लिए साधारण स्कैन का उपयोग कर सकता है या प्रश्न निष्पादन को गति देने के लिए अतिरिक्त डेटा और/या एल्गोरिदम का उपयोग कर सकता है। मैन्टिकोर एक लागत-आधारित ऑप्टिमाइज़र (CBO) का उपयोग करता है, जिसे "प्रश्न ऑप्टिमाइज़र" भी कहा जाता है, यह निर्धारित करने के लिए कि कौन सा दृष्टिकोण अपनाना है।


CBO पूर्ण-पाठ प्रश्नों के प्रदर्शन को भी बढ़ा सकता है। अधिक विवरण के लिए नीचे देखें।


यदि CBO यह निर्धारित करता है कि ऐसा करने से प्रदर्शन में सुधार होगा, तो यह एक या अधिक प्रश्न फ़िल्टरों को निम्नलिखित में से एक इकाई के साथ बदलने का निर्णय ले सकता है:


1. एक **docid सूची** एक विशेष docid-केवल द्वितीयक सूची का उपयोग करती है जो `.spt` विस्तार वाली फ़ाइलों में संग्रहीत होती है। दस्तावेज़ आईडी पर फ़िल्टर को सुधारने के अलावा, docid सूची का उपयोग दस्तावेज़ आईडी से पंक्ति आईडी लुकअप को तेज़ करने और डेमॉन स्टार्टअप के दौरान बड़े किलिस्ट के अनुप्रयोग को तेज़ करने के लिए भी किया जाता है।

2. एक **स्तंभ स्कैन** स्तंभ भंडारण पर निर्भर करता है और केवल स्तंभ गुण पर उपयोग किया जा सकता है। यह प्रत्येक मान को स्कैन करता है और इसे फ़िल्टर के खिलाफ परखता है, लेकिन यह बहुत अधिक अनुकूलित है और सामान्यत: डिफ़ॉल्ट दृष्टिकोण से तेज़ है।

3. **द्वितीयक सूची** सभी गुणों (JSON को छोड़कर) के लिए डिफ़ॉल्ट रूप से उत्पन्न होती हैं। यह मूल्य या मूल्यों की श्रृंखला के अनुरूप पंक्ति आईडी की सूची प्राप्त करने के लिए Manticore की अंतर्निहित उलटी सूची के साथ [PGM सूची](https://pgm.di.unipi.it/) का उपयोग करती है। द्वितीयक सूची को `.spidx` और `.spjidx` विस्तार वाली फ़ाइलों में संग्रहीत किया जाता है।

JSON गुणों पर द्वितीयक सूचियाँ उत्पन्न करने के तरीके की जानकारी के लिए देखें [json_secondary_indexes](../Creating_a_table/Local_tables/Plain_and_real-time_table_settings.md#json_secondary_indexes).


ऑप्टिमाइज़र विभिन्न गुण सांख्यिकी का उपयोग करके प्रत्येक निष्पादन पथ की लागत का आकलन करता है, जिसमें शामिल हैं:


1. एक गुण के भीतर डेटा वितरण पर जानकारी (हिस्टोग्राम, जो `.sphi` फ़ाइलों में संग्रहीत होती है)। जब डेटा को अनुक्रमित किया जाता है, तो स्वचालित रूप से.histograms उत्पन्न होते हैं और CBO के लिए जानकारी का प्राथमिक स्रोत के रूप में कार्य करते हैं।

2. PGM (द्वितीयक सूची) से जानकारी, जो पढ़ने के लिए दस्तावेज़ सूचियों की संख्या का अनुमान लगाने में मदद करती है। यह doclist मर्ज प्रदर्शन का आकलन करने और उपयुक्त मर्ज एल्गोरिदम (प्रायोरिटी क्यू मर्ज या बिटमैप मर्ज) का चयन करने में सहायक होती है।

3. स्तंभ अंतरण सांख्यिकी, जिन्हें स्तंभ डेटा डीकंप्रेशन प्रदर्शन का आकलन करने के लिए उपयोग किया जाता है।

4. एक स्तंभ मिन-मैक्स ट्री। जबकि CBO फ़िल्टर लागू करने के बाद बचे दस्तावेज़ों की संख्या का अनुमान लगाने के लिए.histograms का उपयोग करता है, यह यह भी निर्धारित करने की आवश्यकता है कि फ़िल्टर को कितने दस्तावेज़ों को संसाधित करना पड़ा। स्तंभ गुणों के लिए, मिन-मैक्स ट्री का आंशिक मूल्यांकन इस उद्देश्य के लिए कार्य करता है।

5. पूर्ण-पाठ शब्दकोष। CBO पूर्ण-पाठ पेड़ के आकलन की लागत का अनुमान लगाने के लिए टर्म सांख्यिकी का उपयोग करता है।


ऑप्टिमाइज़र प्रत्येक प्रश्न में उपयोग किए गए फ़िल्टर की निष्पादन लागत की गणना करता है। चूंकि कुछ फ़िल्टरों को कई विभिन्न इकाइयों के साथ बदल दिया जा सकता है (जैसे, एक दस्तावेज़ आईडी के लिए, मैन्टिकोर एक साधारण स्कैन, एक docid सूची लुकअप, एक स्तंभ स्कैन (यदि दस्तावेज़ आईडी स्तंभ है), और एक द्वितीयक सूची का उपयोग कर सकता है), ऑप्टिमाइज़र सभी उपलब्ध संयोजनों का मूल्यांकन करता है। हालांकि, संयोजनों की अधिकतम सीमा 1024 है।
