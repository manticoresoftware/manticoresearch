# Добавление распределённой таблицы с удалёнными агентами

Для понимания того, как добавить распределённую таблицу с удалёнными агентами, важно сначала иметь базовое представление о [распределённых таблицах](../Creating_a_table/Creating_a_distributed_table/Creating_a_distributed_table.md). В этой статье мы сосредоточимся на том, как использовать распределённую таблицу в качестве основы для создания кластера экземпляров Manticore.
<!-- example conf dist 1 -->
Вот пример того, как распределить данные на 4 сервера, каждый из которых обслуживает один из шардов:


<!-- intro -->
##### ini:

<!-- request ini -->
```ini
table mydist {
          type  = distributed
          agent = box1:9312:shard1
          agent = box2:9312:shard2
          agent = box3:9312:shard3
          agent = box4:9312:shard4
}
```
<!-- end -->
В случае сбоя сервера распределённая таблица продолжит работать, но результаты с неработающего шарда будут отсутствовать.

<!-- example conf dist 2 -->
Теперь, когда мы добавили зеркала, каждый шард находится на 2 серверах. По умолчанию мастер (экземпляр searchd с распределённой таблицей) случайным образом выбирает одно из зеркал.

Режим выбора зеркал можно задать с помощью параметра [ha_strategy](../Creating_a_cluster/Remote_nodes/Load_balancing.md#ha_strategy). Помимо стандартного режима `random` существует также `ha_strategy = roundrobin`.

Более продвинутые стратегии, основанные на вероятностях с учётом задержек, включают `noerrors` и `nodeads`. Они не только исключают зеркала с проблемами, но и мониторят время отклика и балансируют нагрузку. Если зеркало отвечает медленнее (например, из-за выполнения каких-то операций), оно будет получать меньше запросов. Когда зеркало восстанавливается и обеспечивает лучшее время отклика, оно получает больше запросов.

<!-- intro -->
##### ini:

<!-- request ini -->
```ini
table mydist {
          type  = distributed
          agent = box1:9312|box5:9312:shard1
          agent = box2:9312:|box6:9312:shard2
          agent = box3:9312:|box7:9312:shard3
          agent = box4:9312:|box8:9312:shard4
}
```
<!-- end -->

<!-- proofread -->

