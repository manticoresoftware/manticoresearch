# Добавление распределенной таблицы с удалёнными агентами

Чтобы понять, как добавить распределенную таблицу с удалёнными агентами, важно сначала иметь базовое понимание о [распределенных таблицах](../Creating_a_table/Creating_a_distributed_table/Creating_a_distributed_table.md) В этой статье мы сосредоточимся на том, как использовать распределенную таблицу в качестве основы для создания кластера экземпляров Manticore.
<!-- пример конфигурации dist 1 -->
Вот пример того, как разделить данные между 4 серверами, каждый из которых обслуживает одну из частей:


<!-- начало -->
##### ini:

<!-- запрос ini -->
```ini
table mydist {
          type  = distributed
          agent = box1:9312:shard1
          agent = box2:9312:shard2
          agent = box3:9312:shard3
          agent = box4:9312:shard4
}
```
<!-- конец -->
В случае сбоя сервера распределенная таблица всё ещё будет работать, но результаты из неработающей части будут отсутствовать.

<!-- пример конфигурации dist 2 -->
Теперь, когда мы добавили зеркала, каждая часть находится на 2 серверах. По умолчанию главный (экземпляр searchd с распределенной таблицей) будет случайным образом выбирать одно из зеркал.

Режим, используемый для выбора зеркал, можно установить с помощью параметра [ha_strategy](../Creating_a_cluster/Remote_nodes/Load_balancing.md#ha_strategy). В дополнение к режиму по умолчанию `random`, также есть `ha_strategy = roundrobin`.

Более продвинутые стратегии, основанные на вероятностях с учётом задержки, включают `noerrors` и `nodeads`. Они не только исключают зеркала с проблемами, но и контролируют время ответа и осуществляют балансировку. Если зеркало отвечает медленнее (например, из-за выполнения каких-то операций на нем), оно будет получать меньше запросов. Когда зеркало восстанавливается и начинает показывать лучшие времена, оно будет получать больше запросов.

<!-- начало -->
##### ini:

<!-- запрос ini -->
```ini
table mydist {
          type  = distributed
          agent = box1:9312|box5:9312:shard1
          agent = box2:9312:|box6:9312:shard2
          agent = box3:9312:|box7:9312:shard3
          agent = box4:9312:|box8:9312:shard4
}
```
<!-- конец -->

<!-- корректура -->
