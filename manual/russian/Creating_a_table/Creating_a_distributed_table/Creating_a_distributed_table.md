# Создание распределенной таблицы

Manticore позволяет создавать **распределенные таблицы**, которые работают как обычные простые или реалтайм таблицы, но на самом деле являются коллекцией дочерних таблиц, используемых для поиска. Когда запрос отправляется в распределенную таблицу, он распределяется между всеми таблицами в коллекции. Сервер затем собирает и обрабатывает ответы, чтобы отсортировать и перерассчитать значения агрегатов, если это необходимо.

С точки зрения клиента, кажется, что он запрашивает одну таблицу.

Распределенные таблицы могут состоять из любой комбинации таблиц, включая:

* Таблицы локального хранения ([простая таблица](../../Creating_a_table/Local_tables/Plain_table.md) и [реальное время](../../Creating_a_table/Local_tables/Real-time_table.md))
* [Удаленные таблицы](../../Creating_a_table/Creating_a_distributed_table/Remote_tables.md)
* Комбинацию локальных и удаленных таблиц
* [Перколирующие таблицы](../../Creating_a_table/Local_tables/Percolate_table.md) (локальные, удаленные или комбинация)
* Одна локальная и несколько удаленных таблиц, или любая другая комбинация

Смешивание перколирующих и шаблонных таблиц с простыми и реалтайм таблицами не рекомендуется.

Распределенная таблица определяется как тип 'распределенная' в конфигурационном файле или через SQL-клаусулю `CREATE TABLE`

#### В конфигурационном файле

```ini
table foo {
    type = distributed
    local = bar
    local = bar1, bar2
    agent = 127.0.0.1:9312:baz
    agent = host1|host2:tbl
    agent = host1:9301:tbl1|host2:tbl2 [ha_strategy=random retry_count=10]
    ...
}
```

#### Через SQL

```sql
CREATE TABLE distributed_index type='distributed' local='local_index' agent='127.0.0.1:9312:remote_table'
```

#### Дети

Суть распределенной таблицы заключается в списке дочерних таблиц, на которые она указывает. Существует два типа дочерних таблиц в распределенной таблице:

1. [Локальные таблицы](../../Creating_a_table/Creating_a_distributed_table/Creating_a_local_distributed_table.md#Creating-a-local-distributed-table): Это таблицы, которые обслуживаются на том же сервере, что и распределенная таблица. Для перечисления локальных таблиц используется синтаксис `local =`. Вы можете перечислить несколько локальных таблиц, используя несколько строк `local =`, или объединить их в один список, разделенный запятыми.

2. [Удаленные таблицы](../../Creating_a_table/Creating_a_distributed_table/Remote_tables.md#agent): Это таблицы, которые обслуживаются где угодно за пределами сервера. Для перечисления удаленных таблиц используется синтаксис `agent =`. Каждая строка представляет собой одну конечную точку или агента. У каждого агента могут быть несколько внешних местоположений и опций для его работы. Более подробная информация [здесь](../../Creating_a_table/Creating_a_distributed_table/Remote_tables.md#agent). Важно отметить, что сервер не имеет никакой информации о типе таблицы, с которой он работает. Это может привести к ошибкам, если, например, вы вызовете `CALL PQ` для удаленной таблицы 'foo', которая не является перколирующей таблицей.

<!-- proofread -->
