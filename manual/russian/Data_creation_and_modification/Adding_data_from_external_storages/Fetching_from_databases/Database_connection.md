# Подключение к базе данных

Определение источника должно содержать настройки соединения, включая хост, порт, учетные данные пользователя или специфические настройки драйвера.

## sql_host

Хост сервера базы данных, к которому нужно подключиться. Обратите внимание, что библиотека клиента MySQL выбирает, подключаться ли по TCP/IP или через UNIX-сокет в зависимости от имени хоста. В частности, "localhost" заставит использовать UNIX-сокет (это режим по умолчанию и обычно рекомендуемый) и "127.0.0.1" заставит использовать TCP/IP.

## sql_port

IP-порт сервера для подключения. 
Для `mysql` по умолчанию это 3306, а для `pgsql` - 5432.

## sql_db

SQL база данных, которую нужно использовать после установки соединения и выполнения дальнейших запросов.

## sql_user

Имя пользователя, используемое для подключения.

## sql_pass

Пароль пользователя, используемый при подключении. Если пароль включает `#` (который можно использовать для добавления комментариев в файл конфигурации), вы можете экранировать его с помощью `\`.

## sql_sock

Имя UNIX-сокета для подключения к локальным серверам базы данных. Обратите внимание, что зависит от настройки `sql_host`, будет ли это значение фактически использоваться.

```ini
sql_sock = /var/lib/mysql/mysql.sock
```

## Специфические настройки для драйверов

### MySQL

#### mysql_connect_flags

Флаги подключения клиента MySQL. Необязательный, значение по умолчанию - 0 (не устанавливать никаких флагов).

Эта опция должна содержать целочисленное значение с суммой флагов. Значение будет передано в mysql_real_connect() без изменений. Флаги, особенно интересные в отношении индексации, с их соответствующими значениями, следующие:

* CLIENT_COMPRESS = 32; может использовать сжатие протокола
* CLIENT_SSL = 2048; переключение на SSL после рукопожатия
* CLIENT_SECURE_CONNECTION = 32768; новая аутентификация 4.1
Например, вы можете указать 2080 (2048+32), чтобы использовать как сжатие, так и SSL, или 32768, чтобы использовать только новую аутентификацию. Изначально эта опция была введена для возможности использования сжатия, когда индексатор и mysqld находятся на разных хостах. Сжатие на каналах 1 Гбит/с скорее всего ухудшает время индексации, хотя и снижает сетевой трафик, как теоретически, так и на практике. Однако включение сжатия на каналах 100 Мбит/с может значительно улучшить время индексации (было сообщено о 20-30% улучшения общего времени индексации). Ваши результаты могут отличаться.

```ini
mysql_connect_flags = 32 # включить сжатие
```

### Настройки сертификатов SSL

* `mysql_ssl_cert` - путь к SSL-сертификату
* `mysql_ssl_key` - путь к файлу ключа SSL
* `mysql_ssl_ca` - путь к CA-сертификату


### unpack_mysqlcompress

```ini
unpack_mysqlcompress_maxsize = 1M
```

Столбцы для распаковки с использованием алгоритма MySQL `UNCOMPRESS()`. Мультизначное, необязательное, значение по умолчанию - пустой список столбцов.

Столбцы, указанные с помощью этой директивы, будут распакованы индексатором с использованием модифицированного алгоритма zlib, используемого функциями MySQL `COMPRESS()` и `UNCOMPRESS()`. При индексации на другой машине, отличной от базы данных, это позволяет разгрузить базу данных и сэкономить на сетевом трафике. Эта функция доступна только если zlib и zlib-devel были доступны во время сборки.

```ini
unpack_mysqlcompress = body_compressed
unpack_mysqlcompress = description_compressed
```

По умолчанию используется буфер размером 16 МБ для распаковки данных. Это можно изменить, установив `unpack_mysqlcompress_maxsize`.

При использовании unpack_mysqlcompress, из-за особенностей реализации, невозможно определить необходимый размер буфера из сжатых данных. Поэтому буфер должен быть предварительно выделен, и распакованные данные не могут превышать размер буфера.

### unpack_zlib

```ini
unpack_zlib = col1
unpack_zlib = col2
```

Столбцы для распаковки с использованием zlib (также известный как deflate, также известный как gunzip). Мультизначное, необязательное, значение по умолчанию - пустой список столбцов. Применяется только для типов источников `mysql` и `pgsql`.

Столбцы, указанные с помощью этой директивы, будут распакованы индексатором с использованием стандартного алгоритма zlib (называемого deflate и также реализованного `gunzip`). При индексации на другой машине, отличной от базы данных, это позволяет разгрузить базу данных и сэкономить на сетевом трафике. Эта функция доступна только если zlib и zlib-devel были доступны во время сборки.

### MSSQL

Флаг аутентификации Windows MS SQL. Использовать ли учетные данные текущей учетной записи Windows для аутентификации при подключении к MS SQL Server.

```ini
mssql_winauth = 1
```

### ODBC

Источники, использующие ODBC, требуют наличия строки DSN (имя источника данных), которую можно установить с помощью `odbc_dsn`.

```ini
odbc_dsn = Driver={Oracle ODBC Driver};Dbq=myDBName;Uid=myUsername;Pwd=myPassword
```

Обратите внимание, что формат зависит от конкретного используемого драйвера ODBC.
<!-- proofread -->
