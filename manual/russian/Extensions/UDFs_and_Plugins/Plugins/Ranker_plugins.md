# Плагины Ranker 

Плагины Ranker позволяют вам реализовать пользовательский рангер, который получает все вхождения совпадающих ключевых слов в документе и вычисляет значение `WEIGHT()`. Их можно вызывать следующим образом:

```sql
SELECT id, attr1 FROM test WHERE match('hello') OPTION ranker=myranker('option1=1');
```
Рабочий процесс вызова осуществляется следующим образом:

1. `XXX_init()` вызывается один раз для каждого запроса к каждой таблице, в самом начале. Несколько параметров запроса передаются ему через структуру `SPH_RANKER_INIT`, включая строки пользовательских параметров (например, "option1=1" в приведенном выше примере).
2. `XXX_update()` вызывается несколько раз для каждого найденного документа, с каждым вхождением совпадающего ключевого слова, переданным в качестве его параметра - структуры `SPH_RANKER_HIT`. Вхождения в каждом документе гарантированно передаются в порядке возрастания значений `hit->hit_pos`.
3. `XXX_finalize()` вызывается один раз для каждого найденного документа, когда больше нет вхождений ключевых слов. Он должен вернуть значение `WEIGHT()`. Эта функция является единственной обязательной.
4. `XXX_deinit()` вызывается один раз для каждого запроса, в самом конце.


<!-- proofread -->
