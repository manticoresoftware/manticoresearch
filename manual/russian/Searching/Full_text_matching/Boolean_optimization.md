# Булева оптимизация
Запросы могут автоматически оптимизироваться, если указано `OPTION boolean_simplify=1`. Некоторые преобразования, выполняемые этой оптимизацией, включают:

* Избыточные скобки: `((A | B) | C)` становится `(A | B | C)`; `((A B) C)` становится `(A B C)`
* Избыточный AND NOT: `((A !N1) !N2)` становится `(A !(N1 | N2))`
* Общий NOT: `((A !N) | (B !N))` становится `((A | B) !N)`
* Общий составной NOT: `((A !(N AA)) | (B !(N BB)))` становится `(((A | B) !N) | (A !AA) | (B !BB))`, если стоимость вычисления N выше суммы вычислений A и B
* Общий подвыражение: `((A (N | AA)) | (B (N | BB)))` становится `(((A | B) N) | (A AA) | (B BB))`, если стоимость вычисления N выше суммы вычислений A и B
* Общие ключевые слова: `(A | "A B"~N)` становится `A`; `("A B" | "A B C")` становится `"A B"`; `("A B"~N | "A B C"~N)` становится `("A B"~N)`
* Общая фраза: `("X A B" | "Y A B")` становится `("("X"|"Y") A B")`
* Общий AND NOT: `((A !X) | (A !Y) | (A !Z))` становится `(A !(X Y Z))`
* Общий OR NOT: `((A !(N | N1)) | (B !(N | N2)))` становится `(( (A !N1) | (B !N2) ) !N)`
Обратите внимание, что оптимизация запросов потребляет процессорное время, поэтому для простых запросов или оптимизированных вручную запросов могут быть лучшие результаты при значении по умолчанию `boolean_simplify=0`. Упрощения чаще всего полезны для сложных запросов или алгоритмически сгенерированных запросов.

> ПРИМЕЧАНИЕ: Это экспериментальная функциональность и должна использоваться с осторожностью. Рекомендуется проверять, что запрос возвращает одинаковые документы с добавлением и без добавления `OPTION boolean_simplify=1`. Хотя эта оптимизация может упростить и улучшить производительность сложных или алгоритмически сгенерированных запросов, она также потребляет дополнительное процессорное время. Для более простых или вручную оптимизированных запросов значение по умолчанию `boolean_simplify=0` может дать лучшие результаты.

Запросы вроде `-dog`, которые потенциально могут включать все документы из коллекции, по умолчанию не разрешены. Чтобы разрешить их, необходимо указать `not_terms_only_allowed=1` либо как [глобальную настройку](../../Server_settings/Searchd.md#not_terms_only_allowed), либо как [опцию поиска](../../Server_settings/Searchd.md#not_terms_only_allowed).

<!-- proofread -->

