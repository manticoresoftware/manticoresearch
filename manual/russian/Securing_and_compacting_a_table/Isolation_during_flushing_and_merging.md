# Изоляция во время сброса и слияния

Manticore обеспечивает изоляцию во время процесса сброса и слияния таблицы реального времени, чтобы изменения не влияли на выполняющиеся запросы.

Например, при компактировании таблицы пара дисковых чанков объединяется и создается новый чанк. В какой-то момент создается новая версия таблицы, где новый чанк заменяет исходную пару. Это происходит бесшовно, так что длительно выполняющийся запрос, использующий исходные чанки, продолжает видеть старую версию таблицы, в то время как новый запрос увидит новую версию с объединённым чанком.

То же самое относится к сбросу RAM чанка, где подходящие сегменты RAM объединяются в новый дисковый чанк, а участвующие сегменты RAM чанка отбрасываются. Во время этой операции Manticore обеспечивает изоляцию для запросов, начатых до начала операции.

Кроме того, эти операции прозрачны для replace и update. Если вы обновляете атрибут в документе, который принадлежит дисковому чанку, объединяемому с другим, обновление будет применено как к тому чанку, так и к результирующему объединённому чанку. Если вы удаляете документ во время слияния, он будет удалён в исходном чанке и также в результирующем объединённом чанке, который либо будет иметь документ, помеченный как удаленный, или не будет содержать такого документа вовсе, если удаление произошло на раннем этапе слияния.
<!-- proofread -->

