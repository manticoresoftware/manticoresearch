# Телеметрия

В Manticore мы собираем различные анонимизированные метрики для повышения качества наших продуктов, включая Manticore Search. Анализируя эти данные, мы можем не только улучшить общую производительность нашего продукта, но и определить, какие функции следует приоритизировать, чтобы предоставить нашим пользователям еще больше ценности. Система телеметрии работает в отдельном потоке в неблокирующем режиме, делая снимки и отправляя их раз в несколько минут.

Мы серьезно относимся к вашей конфиденциальности, и можете быть уверены, что все метрики полностью анонимны и никакая конфиденциальная информация не передается. Однако, если вы все же хотите отключить телеметрию, у вас есть возможность сделать это, выполнив следующие действия:
* Установив переменную окружения `TELEMETRY=0`
* Или установив `telemetry = 0` в секции `searchd` вашего конфигурационного файла

Вот список всех метрик, которые мы собираем:

Символ ⏱️ указывает на то, что метрика собирается периодически, в отличие от других метрик, которые собираются на основе конкретных событий.

| Метрика | Описание |
|-|-|
| `invocation` | Отправлено при запуске Manticore Buddy |
| `plugin_*` | Указывает, что плагин с заданным именем был выполнен, например, `plugin_backup` для выполнения резервного копирования |
| `command_*` | ⏱️ Все метрики с этим префиксом отправляются из запроса `show status` демона Manticore |
| `uptime` | ⏱️ Время работы демона Manticore Search |
| `workers_total` | ⏱️ Общее количество рабочих процессов, используемых Manticore |
| `cluster_count` | ⏱️ Сколько кластеров обрабатывает этот узел |
| `cluster_size` | ⏱️ Сколько узлов во всех кластерах |
| `table_*_count` | ⏱️ Количество таблиц, созданных для каждого типа: обычные, перколяторы, rt или распределенные |
| `*_field_*_count` | ⏱️ Количество для каждого типа поля для таблиц с типами rt и перколятор |
| `columnar` | ⏱️ Указывает, что была использована библиотека Columnar |
| `columnar_field_count` | ⏱️ Количество полей, использующих библиотеку Columnar |

## Метрики резервного копирования

Инструмент резервного копирования Manticore по умолчанию отправляет анонимизированные метрики на сервер метрик Manticore, чтобы помочь улучшить продукт. Если вы не хотите отправлять телеметрию, вы можете отключить ее, запустив инструмент с флагом `--disable-metric` или установив переменную окружения `TELEMETRY=0`.

Следующий список включает все собранные метрики:

| Метрика | Описание |
|-|-|
| `invocation` | Отправлено, когда резервное копирование было инициировано  |
| `failed` | Отправлено в случае неудачного резервного копирования |
| `done` | Отправлено, когда резервное копирование/восстановление успешно |
| `arg_*` | Аргументы, использованные для запуска инструмента (исключая имена индексов и т.д.) |
| `backup_store_versions_fails` | Указывает на ошибку при сохранении версии Manticore в резервной копии |
| `backup_table_count` | Общее количество резервных копий таблиц |
| `backup_no_permissions` | Неудачное резервное копирование из-за недостатка прав на целевую директорию |
| `backup_total_size` | Общий размер полной резервной копии |
| `backup_time` | Продолжительность резервного копирования |
| `restore_searchd_running` | Не удалось запустить процесс восстановления из-за того, что searchd уже работает |
| `restore_no_config_file` | Конфигурационный файл не найден в резервной копии во время восстановления |
| `restore_time` | Продолжительность восстановления |
| `fsync_time` | Продолжительность fsync |
| `restore_target_exists` | Происходит, когда папка или индекс уже существуют в целевой папке для восстановления |
| `terminations` | Указывает, что процесс был завершен |
| `signal_*` | Сигнал, используемый для завершения процесса |
| `tables` | Количество таблиц в Manticore |
| `config_unreachable` | Указанный конфигурационный файл не существует |
| `config_data_dir_missing` | Не удалось разобрать `data_dir` из указанного конфигурационного файла |
| `config_data_dir_is_relative` | Путь `data_dir` в конфигурационном файле экземпляра Manticore является относительным |

## Метки

Каждая метрика имеет следующие метки:

| Метка | Описание |
|-|-|
| `collector` | `buddy`. Указывает, что эта метрика собирается через Manticore Buddy |
| `os_name` | Название операционной системы |
| `os_release_name` | Название из `/etc/os-release`, если присутствует, или `unknown` |
| `os_release_version` | Версия из `/etc/os-release`, если присутствует, или `unknown` |
| `dockerized` | Если она запущена в среде Docker |
| `official_docker` | В случае Docker это флаг, который показывает, что мы используем официальный образ |
| `machine_id` | Идентификатор сервера (содержимое `/etc/machine-id` в Linux) |
| `arch` | Архитектура машины, на которой мы работаем |
| `manticore_version` | Версия Manticore |
| `columnar_version` | Версия библиотеки Columnar, если она установлена |
| `secondary_version` | Версия вторичной библиотеки, если библиотека Columnar установлена |
| `knn_version` | Версия библиотеки KNN, если библиотека Columnar установлена |
| `buddy_version`| Версия Manticore Buddy |

<!-- proofread -->

