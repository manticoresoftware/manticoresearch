––– comment –––
Test MySQL Protocol authentication (mysql_native_password).
Spec: https://github.com/manticoresoftware/manticoresearch/blob/wip_auth/src/auth/spec.md
Issue: https://github.com/manticoresoftware/manticoresearch/issues/2983
Admin credentials: admin / adminpass (bootstrap via auth.json)

BUG: Error code 1047 (08S01) instead of standard MySQL 1045 (28000)
BUG: Non-existent user shows "using password: NO" even when password provided
––– comment –––
––– block: ../base/start-searchd-with-auth –––
––– comment –––
––– 1.1.1 Successful login with correct credentials –––
EXPECTED: Success, returns result
––– comment –––
––– input –––
MYSQL_PWD=adminpass mysql -E -uadmin -h0 -P9306 -e "SELECT 1 AS test;"
––– output –––
*************************** 1. row ***************************
test: 1
––– comment –––
––– 1.1.2 Reject with wrong password –––
EXPECTED per spec: ERROR 1045 (28000): Access denied for user 'admin' (using password: YES)
ACTUAL: ERROR 1047 (08S01) — wrong error code
––– comment –––
––– input –––
MYSQL_PWD=wrongpass mysql -uadmin -h0 -P9306 -e "SELECT 1;" 2>&1
––– output –––
ERROR 1047 (08S01): Access denied for user 'admin' (using password: YES)
––– comment –––
––– 1.1.3 Reject with non-existent user –––
EXPECTED per spec: ERROR 1045 (28000): Access denied for user 'nonexistent' (using password: YES)
ACTUAL: ERROR 1047 (08S01) and shows "using password: NO" — wrong
––– comment –––
––– input –––
MYSQL_PWD=anypass mysql -unonexistent -h0 -P9306 -e "SELECT 1;" 2>&1
––– output –––
ERROR 1047 (08S01): Access denied for user 'nonexistent' (using password: NO)
––– comment –––
––– 1.1.4 Reject with empty password –––
EXPECTED per spec: ERROR 1045 (28000): Access denied for user 'admin' (using password: NO)
ACTUAL: ERROR 1047 (08S01) — wrong error code
––– comment –––
––– input –––
mysql -uadmin -h0 -P9306 -e "SELECT 1;" 2>&1
––– output –––
ERROR 1047 (08S01): Access denied for user 'admin' (using password: NO)
