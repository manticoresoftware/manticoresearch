––– block: ../base/start-searchd-with-buddy –––
––– input –––
manticore-load --quiet --json --init="CREATE TABLE test (id bigint, usertest text stored indexed, category string, age int, salary float, discount float, is_active bool, last_login timestamp, product_codes multi, large_values multi64, additional_info json, location_vector float_vector)" --load="INSERT INTO test (id, usertest, category, age, salary, discount, is_active, last_login, product_codes, large_values, additional_info, location_vector) VALUES (<increment>, '<text/5/20>', '<text/5/10>', <int/1/100>, <float/1.0/100.0>, <float/0.0/10.0>, <int/0/1>, <int/1609459200/1704067200>, (<array/1/10/1/100>), (<array/1/10/-100000/100000>), '{\"key\":\"value\"}', (<array/4/4/1.0/10.0>))" --batch-size=10000 --threads=4 --total=1000000
––– output –––
{
    "threads": %{NUMBER},
    "batch_size": %{NUMBER},
    "time": "%{NUMBER}:%{NUMBER}",
    "total_operations": 1000000,
    "operations_per_second": %{NUMBER},
    "qps": {
        "avg": #!/[0-9]+(\.[0-9]+)?/!#,
        "p99": %{NUMBER},
        "p95": %{NUMBER},
        "p5": %{NUMBER},
        "p1": %{NUMBER}
    },
    "latency": {
        "avg": #!/[0-9]+(\.[0-9]+)?/!#,
        "p50": %{NUMBER},
        "p95": %{NUMBER},
        "p99": %{NUMBER}
    }
}
––– input –––
mysql -h0 -P9306 -e "SELECT * FROM test ORDER BY id ASC LIMIT 100000 OPTION max_matches=100000;" > /tmp/test_data.txt
––– output –––
––– input –––
md5sum /tmp/test_data.txt
––– output –––
299561871af20e6b4ae29692f2fbced8  /tmp/test_data.txt
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES"
––– output –––
+-------+------+
| Table | Type |
+-------+------+
| test  | rt   |
+-------+------+
––– input –––
mysql -P9306 -h0 -e "SELECT COUNT(*) FROM test;"
––– output –––
+----------+
| count(*) |
+----------+
|  1000000 |
+----------+
––– input –––
mysql -P9306 -h0 -e "DESCRIBE test;"
––– output –––
+-----------------+--------------+----------------+
| Field           | Type         | Properties     |
+-----------------+--------------+----------------+
| id              | bigint       |                |
| usertest        | text         | indexed stored |
| category        | string       |                |
| age             | uint         |                |
| salary          | float        |                |
| discount        | float        |                |
| is_active       | bool         |                |
| last_login      | timestamp    |                |
| product_codes   | mva          |                |
| large_values    | mva64        |                |
| additional_info | json         |                |
| location_vector | float_vector |                |
+-----------------+--------------+----------------+
––– input –––
mysql -h0 -P9306 -e "SELECT * FROM test ORDER BY id ASC LIMIT 10;"
––– output –––
+------+---------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------+------------+------------+-----------+------------+-------------------------+-------------------------------------------------------------------+-----------------+---------------------------------------+
| id   | usertest                                                                                                                                          | category                                                                   | age  | salary     | discount   | is_active | last_login | product_codes           | large_values                                                      | additional_info | location_vector                       |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------+------------+------------+-----------+------------+-------------------------+-------------------------------------------------------------------+-----------------+---------------------------------------+
|    1 | At understood gave always east fake, dull internationally sent. At cold; hot! it dark low today.                                                  | Gave hardly been vaguely 1000 this.                                        |    7 |   2.365162 |   5.817693 |         0 | 1639945392 | 55                      | -94236,-72461,-60893,-8400,86868,88029                            | {"key":"value"} | 8.000000,7.000000,5.000000,7.000000   |
|    2 | Seen feel economically beautiful legally sick poor incorrectly.                                                                                   | Seen privately understood short universally! yearly.                       |   90 |  16.873980 |   8.455115 |         1 | 1680222744 | 4,15,29,37,83,90,91,92  | -23549,-3549,43790,91332                                          | {"key":"value"} | 2.000000,8.000000,10.000000,5.000000  |
|    3 | Drove young? lost probably came knew felt has hot.                                                                                                | Positively wet quickly quietly need tell poor spring evening.              |   97 |  25.303282 |   0.551904 |         0 | 1612008809 | 1,20,36,40,56,71,83     | -98459,-87441,-74083,-49707,-38090,-21342,57513,79216,90976,92580 | {"key":"value"} | 1.000000,10.000000,6.000000,3.000000  |
|    4 | Sick; kept angry politically closed understand regularly became? fell. Brought.                                                                   | The. Thirsty do poor dead; lazy let.                                       |   23 |  95.348030 | 0.70701975 |         0 | 1628499508 | 20,60,69,73,95,96       | 26497,73063,73768,87840                                           | {"key":"value"} | 5.000000,3.000000,1.000000,3.000000   |
|    5 | Hard get wrote excited deep suddenly foolish they unsuccessfully spoke might does, front! stood south.                                            | Came scientifically sad afraid, meet positively! were spent.               |   68 |  51.716961 | 7.22804546 |         1 | 1640385308 | 13,43,62,65             | -14867,57637                                                      | {"key":"value"} | 5.000000,9.000000,5.000000,4.000000   |
|    6 | Angry! quietly lazy educationally professionally lazy; stale the felt dark get; low dusk instantly front, shallow.                                | Hot full monthly cut may calm be sharp cut serious.                        |   43 |  82.251091 |   9.727920 |         0 | 1632898091 | 79,94,95,100            | -95455,-50953,-46814,-21679,-13767,-13120,23684,27025,33011,78959 | {"key":"value"} | 2.000000,2.000000,1.000000,3.000000   |
|    7 | 100, 50 needed specifically serious do bring below began! rich.                                                                                   | Did unhappily let alive softly individually correctly big informally work. |   77 | 5.13097858 | 0.77633089 |         0 | 1702796380 | 1,11,53,72              | -85222,-77797,-74784,-66549,-38110,-15259,4122,21232,39248,81898  | {"key":"value"} | 4.000000,10.000000,8.000000,7.000000  |
|    8 | She; constantly send down spiritually? maybe happy feel educationally! from draw, internationally; made must emotionally far, usually light west. | Kept big specifically weak held.                                           |   17 |  47.042759 |   6.636477 |         1 | 1680031415 | 13,37,38,39,41,57,80,89 | -88459,-28425,-7018,-3494,58953,86226                             | {"key":"value"} | 7.000000,10.000000,1.000000,10.000000 |
|    9 | Generally clean! ask has unfortunately closed afraid! spoke scientifically rich lay.                                                              | Up thirsty. Commonly wrote specifically healthy wrong culturally.          |   22 |  30.752516 |   2.306853 |         0 | 1613101874 | 2,79,81                 | -87459,-77385,-52673,-29092,-18124,8442,93363                     | {"key":"value"} | 10.000000,4.000000,6.000000,10.000000 |
|   10 | Real late suddenly! from legally certainly you try outside mentally now hurt 4? often? brave dull hourly lose. Spend autumn.                      | Happily unusually hold clever that! sometimes illegally.                   |   20 |  17.930206 |   4.031827 |         1 | 1693258069 | 50,58,67,69             | -69242,-30230,-10666,38335,45013,71495,87473                      | {"key":"value"} | 7.000000,6.000000,3.000000,8.000000   |
+------+---------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------+------------+------------+-----------+------------+-------------------------+-------------------------------------------------------------------+-----------------+---------------------------------------+
––– input –––
mysql -h0 -P9206 -e "
FLUSH RAMCHUNK test;
FREEZE test;
$(for n in $(seq 1 100); do
    echo "UPDATE test SET category='updated' WHERE id=$n;"
done)
" > /dev/null 2>&1 &
pid=$!
wait $pid
grep -i "error" /var/log/manticore/searchd.log
––– output –––
––– input –––
mysql -h0 -P9306 -e "SELECT * FROM test ORDER BY id ASC LIMIT 5;"
––– output –––
+------+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------+------+-----------+------------+-----------+------------+------------------------+-------------------------------------------------------------------+-----------------+--------------------------------------+
| id   | usertest                                                                                               | category                                                      | age  | salary    | discount   | is_active | last_login | product_codes          | large_values                                                      | additional_info | location_vector                      |
+------+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------+------+-----------+------------+-----------+------------+------------------------+-------------------------------------------------------------------+-----------------+--------------------------------------+
|    1 | At understood gave always east fake, dull internationally sent. At cold; hot! it dark low today.       | Gave hardly been vaguely 1000 this.                           |    7 |  2.365162 |   5.817693 |         0 | 1639945392 | 55                     | -94236,-72461,-60893,-8400,86868,88029                            | {"key":"value"} | 8.000000,7.000000,5.000000,7.000000  |
|    2 | Seen feel economically beautiful legally sick poor incorrectly.                                        | Seen privately understood short universally! yearly.          |   90 | 16.873980 |   8.455115 |         1 | 1680222744 | 4,15,29,37,83,90,91,92 | -23549,-3549,43790,91332                                          | {"key":"value"} | 2.000000,8.000000,10.000000,5.000000 |
|    3 | Drove young? lost probably came knew felt has hot.                                                     | Positively wet quickly quietly need tell poor spring evening. |   97 | 25.303282 |   0.551904 |         0 | 1612008809 | 1,20,36,40,56,71,83    | -98459,-87441,-74083,-49707,-38090,-21342,57513,79216,90976,92580 | {"key":"value"} | 1.000000,10.000000,6.000000,3.000000 |
|    4 | Sick; kept angry politically closed understand regularly became? fell. Brought.                        | The. Thirsty do poor dead; lazy let.                          |   23 | 95.348030 | 0.70701975 |         0 | 1628499508 | 20,60,69,73,95,96      | 26497,73063,73768,87840                                           | {"key":"value"} | 5.000000,3.000000,1.000000,3.000000  |
|    5 | Hard get wrote excited deep suddenly foolish they unsuccessfully spoke might does, front! stood south. | Came scientifically sad afraid, meet positively! were spent.  |   68 | 51.716961 | 7.22804546 |         1 | 1640385308 | 13,43,62,65            | -14867,57637                                                      | {"key":"value"} | 5.000000,9.000000,5.000000,4.000000  |
+------+--------------------------------------------------------------------------------------------------------+---------------------------------------------------------------+------+-----------+------------+-----------+------------+------------------------+-------------------------------------------------------------------+-----------------+--------------------------------------+
