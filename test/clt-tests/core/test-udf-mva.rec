Test UDF functions makemva, makemva64, and makefloatvec with seed parameter support

––– input –––
apt -y install gcc > /dev/null 2>&1; echo $?
––– output –––
0
––– input –––
gcc -fPIC -shared -o /usr/local/lib/manticore/udfexample.so /usr/include/manticore/udfexample.c
––– output –––
––– block: ../base/start-searchd –––
––– input –––
mysql -v -P9306 -h0 -e "CREATE FUNCTION makemva RETURNS MULTI SONAME 'udfexample.so'"
––– output –––
--------------
CREATE FUNCTION makemva RETURNS MULTI SONAME 'udfexample.so'
--------------
––– input –––
mysql -v -P9306 -h0 -e "CREATE FUNCTION makemva64 RETURNS MULTI64 SONAME 'udfexample.so'"
––– output –––
--------------
CREATE FUNCTION makemva64 RETURNS MULTI64 SONAME 'udfexample.so'
--------------
––– input –––
mysql -v -P9306 -h0 -e "CREATE FUNCTION makefloatvec RETURNS FLOAT_VECTOR SONAME 'udfexample.so'"
––– output –––
--------------
CREATE FUNCTION makefloatvec RETURNS FLOAT_VECTOR SONAME 'udfexample.so'
--------------
––– input –––
manticore-load --quiet --drop --batch-size=1000 --threads=5 --total=10000 --init="CREATE TABLE test(id bigint, name text, type int)" --load="INSERT INTO test(id,name,type) VALUES(<increment>,'<text/10/100>',<int/1/100>)" 2>&1 | grep -E "(Threads|Total Docs|Docs/Sec)" || echo "Load completed"
––– output –––
Threads ; Batch     ; Time        ; Total Docs  ; Docs/Sec    ; Avg QPS     ; p99 QPS     ; p95 QPS     ; p5 QPS      ; p1 QPS      ; Lat Avg     ; Lat p50     ; Lat p95     ; Lat p99     ;
––– input –––
manticore-load --quiet --drop --batch-size=1000 --threads=5 --total=10000 --init="CREATE TABLE test2(id bigint, name text, type int)" --load="INSERT INTO test2(id,name,type) VALUES(<increment/10000>,'<text/10/100>',<int/1/100>)" 2>&1 | grep -E "(Threads|Total Docs|Docs/Sec)" || echo "Load completed"
––– output –––
Threads ; Batch     ; Time        ; Total Docs  ; Docs/Sec    ; Avg QPS     ; p99 QPS     ; p95 QPS     ; p5 QPS      ; p1 QPS      ; Lat Avg     ; Lat p50     ; Lat p95     ; Lat p99     ;
––– input –––
manticore-load --quiet --drop --batch-size=1000 --threads=5 --total=10000 --init="CREATE TABLE test3(id bigint, name text, type int)" --load="INSERT INTO test3(id,name,type) VALUES(<increment/20000>,'<text/10/100>',<int/1/100>)" 2>&1 | grep -E "(Threads|Total Docs|Docs/Sec)" || echo "Load completed"
––– output –––
Threads ; Batch     ; Time        ; Total Docs  ; Docs/Sec    ; Avg QPS     ; p99 QPS     ; p95 QPS     ; p5 QPS      ; p1 QPS      ; Lat Avg     ; Lat p50     ; Lat p95     ; Lat p99     ;
––– input –––
mysql -v -P9306 -h0 -e "SELECT id, makemva(1) as mva64_values FROM test limit 3\G"
––– output –––
--------------
SELECT id, makemva(1) as mva64_values FROM test limit 3
--------------
*************************** 1. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 85,123,224,309,430,535,548,601,822,834,848
*************************** 2. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 85,123,224,309,430,535,548,601,822,834,848
*************************** 3. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 85,123,224,309,430,535,548,601,822,834,848
––– input –––
mysql -v -P9306 -h0 -e "SELECT id, makemva64(1) as mva64_values FROM test limit 3\G"
––– output –––
--------------
SELECT id, makemva64(1) as mva64_values FROM test limit 3
--------------
*************************** 1. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834
*************************** 2. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834
*************************** 3. row ***************************
          id: #!/[0-9]+/!#
mva64_values: 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834
––– input –––
mysql -v -P9306 -h0 -e "SELECT id, makefloatvec(1) as float_vec FROM test limit 3\G"
––– output –––
--------------
SELECT id, makefloatvec(1) as float_vec FROM test limit 3
--------------
*************************** 1. row ***************************
       id: #!/[0-9]+/!#
float_vec: 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
*************************** 2. row ***************************
       id: #!/[0-9]+/!#
float_vec: 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
*************************** 3. row ***************************
       id: #!/[0-9]+/!#
float_vec: 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
––– input –––
mysql -v -P9306 -h0 -e "SELECT id, type FROM test facet makemva(1)"
––– output –––
--------------
SELECT id, type FROM test facet makemva(1)
--------------
+------+------+
| id   | type |
+------+------+
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
+------+------+
+------------+----------+
| makemva(1) | count(*) |
+------------+----------+
|        848 |    10000 |
|        834 |    10000 |
|        822 |    10000 |
|        601 |    10000 |
|        548 |    10000 |
|        535 |    10000 |
|        430 |    10000 |
|        309 |    10000 |
|        224 |    10000 |
|        123 |    10000 |
|         85 |    10000 |
+------------+----------+
––– input –––
mysql -v -P9306 -h0 -e "SELECT id, type FROM test,test2 facet makemva(1)"
––– output –––
--------------
SELECT id, type FROM test,test2 facet makemva(1)
--------------
+-------+------+
| id    | type |
+-------+------+
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
| #!/[0-9]+/!# | #!/[0-9]+/!# |
+-------+------+
+------------+----------+
| makemva(1) | count(*) |
+------------+----------+
|         85 |    20000 |
|        123 |    20000 |
|        224 |    20000 |
|        309 |    20000 |
|        430 |    20000 |
|        535 |    20000 |
|        548 |    20000 |
|        601 |    20000 |
|        822 |    20000 |
|        834 |    20000 |
|        848 |    20000 |
+------------+----------+
––– input –––
mysql -v -P9306 -h0 -e "create table d type='distributed' agent='localhost:9312:test' agent='localhost:9312:test2' local='test3'"
––– output –––
--------------
create table d type='distributed' agent='localhost:9312:test' agent='localhost:9312:test2' local='test3'
--------------
––– input –––
mysql -v -P9306 -h0 -e "select groupby(), makemva(1) m, count(*) from d where match('knew') and all(m) in (123,234) group by m order by count(*) desc;"
––– output –––
--------------
select groupby(), makemva(1) m, count(*) from d where match('knew') and all(m) in (123,234) group by m order by count(*) desc
--------------
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva(1) from d where match('knew')"
––– output –––
--------------
select id, makemva(1) from d where match('knew')
--------------
+-------+--------------------------------------------+
| id    | makemva(1)                                 |
+-------+--------------------------------------------+
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |
+-------+--------------------------------------------+
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva64(1) from d where match('knew')"
––– output –––
--------------
select id, makemva64(1) from d where match('knew')
--------------
+-------+-------------------------------------------------------+
| id    | makemva64(1)                                          |
+-------+-------------------------------------------------------+
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |
+-------+-------------------------------------------------------+
––– input –––
mysql -P9306 -h0 -e "select id, makefloatvec(1) from d where match('knew') order by weight() desc, id asc limit 3\G"
––– output –––
*************************** 1. row ***************************
             id: 2625
makefloatvec(1): 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
*************************** 2. row ***************************
             id: 4037
makefloatvec(1): 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
*************************** 3. row ***************************
             id: 4203
makefloatvec(1): 59.000000,22.299999,8.400000,42.900002,12.200000,54.700001,60.000000,83.300003,53.400002,84.699997,30.799999,82.099998,86.599998,49.900002,28.799999,96.900002,1.400000,16.700001,70.000000,67.699997,37.000000,76.300003,7.200000,52.099998,39.799999,61.500000,96.400002,74.900002,70.599998,96.300003,80.000000,92.900002,27.000000,41.500000,38.799999,33.299999,12.200000,42.700001,75.199997,86.500000,21.400000,75.900002,52.400002,21.299999,83.400002,65.099998,24.000000,71.300003,70.199997,24.700001,21.200001,40.500000,14.600000,47.500000,37.599998,26.500000,91.000000,63.099998,18.000000,89.300003,75.400002,15.500000,81.599998,40.099998,86.199997,15.900000,32.400002,46.099998,71.400002,40.299999,74.400002,76.099998,16.600000,47.900002,4.400000,29.299999,77.800003,25.100000,68.800003,21.700001,11.800000,59.099998,44.400002,82.099998,21.000000,99.500000,20.000000,63.299999,95.000000,65.500000,92.400002,30.100000,74.599998,3.500000,4.000000,42.500000,48.599998,28.700001,11.600000,45.299999,25.799999,79.500000,29.600000,29.700001,83.000000,79.099998,39.599998,71.699997,33.799999,46.700001,56.000000,11.300000,64.599998,2.300000,78.000000,27.700001,92.199997,1.900000,4.800000,49.700001,69.400002,82.300003,6.000000,51.700001,49.799999,91.500000,58.400002,20.100000
––– input –––
mysql -v -P9306 -h0 -e "select groupby(), makemva(1) m, count(*) from d where match('knew') group by m order by count(*) desc"
––– output –––
--------------
select groupby(), makemva(1) m, count(*) from d where match('knew') group by m order by count(*) desc
--------------
+-----------+--------------------------------------------+----------+
| groupby() | m                                          | count(*) |
+-----------+--------------------------------------------+----------+
|        85 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       123 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       224 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       309 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       430 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       535 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       548 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       601 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       822 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       834 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       848 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
+-----------+--------------------------------------------+----------+
––– input –––
mysql -v -P9306 -h0 -e "select groupby(), makemva(1) m, count(*) from d where match('knew') and any(m) in (85,123) group by m order by count(*) desc"
––– output –––
--------------
select groupby(), makemva(1) m, count(*) from d where match('knew') and any(m) in (85,123) group by m order by count(*) desc
--------------
+-----------+--------------------------------------------+----------+
| groupby() | m                                          | count(*) |
+-----------+--------------------------------------------+----------+
|        85 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       123 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       224 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       309 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       430 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       535 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       548 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       601 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       822 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       834 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
|       848 | 85,123,224,309,430,535,548,601,822,834,848 |     3828 |
+-----------+--------------------------------------------+----------+
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva(1) m, greatest(m) from d where match('knew')"
––– output –––
--------------
select id, makemva(1) m, greatest(m) from d where match('knew')
--------------
+-------+--------------------------------------------+-------------+
| id    | m                                          | greatest(m) |
+-------+--------------------------------------------+-------------+
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |         848 |
+-------+--------------------------------------------+-------------+
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva64(1) m, greatest(m) from d where match('knew')"
––– output –––
--------------
select id, makemva64(1) m, greatest(m) from d where match('knew')
--------------
+-------+-------------------------------------------------------+-------------+
| id    | m                                                     | greatest(m) |
+-------+-------------------------------------------------------+-------------+
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |        9834 |
+-------+-------------------------------------------------------+-------------+
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva(1) m, least(m) from d where match('knew')"
––– output –––
--------------
select id, makemva(1) m, least(m) from d where match('knew')
--------------
+-------+--------------------------------------------+----------+
| id    | m                                          | least(m) |
+-------+--------------------------------------------+----------+
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
| #!/[0-9]+/!# | 85,123,224,309,430,535,548,601,822,834,848 |       85 |
+-------+--------------------------------------------+----------+
––– input –––
mysql -v -P9306 -h0 -e "select id, makemva64(1) m, least(m) from d where match('knew')"
––– output –––
--------------
select id, makemva64(1) m, least(m) from d where match('knew')
--------------
+-------+-------------------------------------------------------+----------+
| id    | m                                                     | least(m) |
+-------+-------------------------------------------------------+----------+
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
| #!/[0-9]+/!# | 822,1309,1535,3601,4085,4548,4848,5224,6430,9123,9834 |      822 |
+-------+-------------------------------------------------------+----------+
