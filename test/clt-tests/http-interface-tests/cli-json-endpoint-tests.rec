––– block: ../base/start-searchd –––
––– input –––
curl -s "http://localhost:9308/cli_json" -d "SHOW VERSION"; echo
––– output –––
[{"total":%{NUMBER},"error":"","warning":"","columns":[{"Component":{"type":"string"}},{"Version":{"type":"string"}}],"data":[{"Component":"Daemon","Version":"%{VERSION}"},{"Component":"Columnar","Version":"columnar %{VERSION}"},{"Component":"Secondary","Version":"secondary %{VERSION}"},{"Component":"KNN","Version":"knn %{VERSION}"},{"Component":"Buddy","Version":"buddy v%{VERSION}"}]}]
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE t (id INT, value TEXT, value_attr STRING) min_infix_len = '3' min_prefix_len = '3'; INSERT INTO t VALUES (1, 'example', 'example'), (2, 'test', 'test');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW CREATE TABLE t;"
––– output –––
+-------+------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                               |
+-------+------------------------------------------------------------------------------------------------------------+
| t     | CREATE TABLE t (
id bigint,
value text,
value_attr string attribute
) min_prefix_len='3' min_infix_len='3' |
+-------+------------------------------------------------------------------------------------------------------------+
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from t"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":1,"value":"example","value_attr":"example"},
{"id":2,"value":"test","value_attr":"test"}
],
"total":2,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "show tables"; echo
––– output –––
[{
"columns":[{"Table":{"type":"string"}},{"Type":{"type":"string"}}],
"data":[
{"Table":"t","Type":"rt"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "describe t"; echo
––– output –––
[{
"columns":[{"Field":{"type":"string"}},{"Type":{"type":"string"}},{"Properties":{"type":"string"}}],
"data":[
{"Field":"id","Type":"bigint","Properties":""},
{"Field":"value","Type":"text","Properties":"indexed stored"},
{"Field":"value_attr","Type":"string","Properties":""}
],
"total":3,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from t where match('example')"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":1,"value":"example","value_attr":"example"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "show meta"; echo
––– output –––
[{
"columns":[{"Variable_name":{"type":"string"}},{"Value":{"type":"string"}}],
"data":[
{"Variable_name":"total","Value":"0"},
{"Variable_name":"total_found","Value":"0"},
{"Variable_name":"total_relation","Value":"eq"},
{"Variable_name":"time","Value":"0.000"}
],
"total":4,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "SELECT * FROM t WHERE MATCH('example') OPTION ranker=bm25"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":1,"value":"example","value_attr":"example"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "SELECT * FROM t WHERE MATCH('exa*')"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":1,"value":"example","value_attr":"example"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from t order by id desc limit 1"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":2,"value":"test","value_attr":"test"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from t order by id asc limit 1"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":1,"value":"example","value_attr":"example"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from t limit 1 offset 1"; echo
––– output –––
[{
"columns":[{"id":{"type":"long long"}},{"value":{"type":"string"}},{"value_attr":{"type":"string"}}],
"data":[
{"id":2,"value":"test","value_attr":"test"}
],
"total":1,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select count(*) as cnt, id from t group by id"; echo
––– output –––
[{
"columns":[{"cnt":{"type":"long long"}},{"id":{"type":"long long"}}],
"data":[
{"cnt":1,"id":1},
{"cnt":1,"id":2}
],
"total":2,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select count(*) as cnt, value_attr from t group by value_attr"; echo
––– output –––
[{
"columns":[{"cnt":{"type":"long long"}},{"value_attr":{"type":"string"}}],
"data":[
{"cnt":1,"value_attr":"example"},
{"cnt":1,"value_attr":"test"}
],
"total":2,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "show meta"; echo
––– output –––
[{
"columns":[{"Variable_name":{"type":"string"}},{"Value":{"type":"string"}}],
"data":[
{"Variable_name":"total","Value":"0"},
{"Variable_name":"total_found","Value":"0"},
{"Variable_name":"total_relation","Value":"eq"},
{"Variable_name":"time","Value":"0.000"}
],
"total":4,
"error":"",
"warning":""
}]
––– input –––
curl -s "http://localhost:9308/cli_json" -d "select * from nonexistent_table"; echo
––– output –––
{"error":"unknown local table(s) 'nonexistent_table' in search request"}
