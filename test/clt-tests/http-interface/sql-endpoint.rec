––– block: ../base/start-searchd –––
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "SHOW VERSION"; echo
––– output –––
[{"total":%{NUMBER},"error":"","warning":"","columns":[{"Component":{"type":"string"}},{"Version":{"type":"string"}}],"data":[{"Component":"Daemon","Version":"%{VERSION}"},{"Component":"Columnar","Version":"columnar %{VERSION}"},{"Component":"Secondary","Version":"secondary %{VERSION}"},{"Component":"KNN","Version":"knn %{VERSION}"},{"Component":"Buddy","Version":"buddy v%{VERSION}"}]}]
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE t (id INT, value TEXT, value_attr STRING) min_infix_len = '3' min_prefix_len = '3'; INSERT INTO t VALUES (1, 'example', 'example'), (2, 'test', 'test');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW CREATE TABLE t;"
––– output –––
+-------+------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                               |
+-------+------------------------------------------------------------------------------------------------------------+
| t     | CREATE TABLE t (
id bigint,
value text,
value_attr string attribute
) min_prefix_len='3' min_infix_len='3' |
+-------+------------------------------------------------------------------------------------------------------------+
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from t"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"eq","hits":[{"_id":1,"_score":1,"_source":{"value":"example","value_attr":"example"}},{"_id":2,"_score":1,"_source":{"value":"test","value_attr":"test"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from t where match('example')"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":1,"total_relation":"eq","hits":[{"_id":1,"_score":1643,"_source":{"value":"example","value_attr":"example"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "SELECT * FROM t WHERE MATCH('example') OPTION ranker=bm25"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":1,"total_relation":"eq","hits":[{"_id":1,"_score":1643,"_source":{"value":"example","value_attr":"example"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "SELECT * FROM t WHERE MATCH('exa*')"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":1,"total_relation":"eq","hits":[{"_id":1,"_score":1643,"_source":{"value":"example","value_attr":"example"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from t order by id desc limit 1"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"eq","hits":[{"_id":2,"_score":1,"_source":{"value":"test","value_attr":"test"}}]},"scroll":"eyJvcmRlcl9ieV9zdHIiOiJpZCBkZXNjIiwib3JkZXJfYnkiOlt7ImF0dHIiOiJpZCIsImRlc2MiOnRydWUsInZhbHVlIjoyLCJ0eXBlIjoiaW50In1dfQ=="}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from t order by id asc limit 1"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"eq","hits":[{"_id":1,"_score":1,"_source":{"value":"example","value_attr":"example"}}]},"scroll":"eyJvcmRlcl9ieV9zdHIiOiJpZCBhc2MiLCJvcmRlcl9ieSI6W3siYXR0ciI6ImlkIiwiZGVzYyI6ZmFsc2UsInZhbHVlIjoxLCJ0eXBlIjoiaW50In1dfQ=="}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from t limit 1 offset 1"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"gte","hits":[{"_id":2,"_score":1,"_source":{"value":"test","value_attr":"test"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select count(*) as cnt, id from t group by id"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"eq","hits":[{"_id":1,"_score":1,"_source":{"cnt":1}},{"_id":2,"_score":1,"_source":{"cnt":1}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select count(*) as cnt, value_attr from t group by value_attr"; echo
––– output –––
{"took":%{NUMBER},"timed_out":false,"hits":{"total":2,"total_relation":"eq","hits":[{"_score":1,"_source":{"cnt":1,"value_attr":"example"}},{"_score":1,"_source":{"cnt":1,"value_attr":"test"}}]}}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "show tables"; echo
––– output –––
{"error":"only SELECT queries are supported"}
––– input –––
curl -s -X POST "http://localhost:9308/sql" -d "select * from nonexistent_table"; echo
––– output –––
{"error":"unknown local table(s) 'nonexistent_table' in search request"}
