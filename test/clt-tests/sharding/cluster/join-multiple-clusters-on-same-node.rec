––– block: ../base/init –––
––– block: ../base/start-searchd-1 –––
––– block: ../base/start-searchd-2 –––
––– block: ../base/start-searchd-3 –––
––– input –––
mysql -h0 -P19306 -e "create cluster a 'a' as path"
––– output –––
––– input –––
mysql -h0 -P19306 -e "create cluster b 'b' as path"
––– output –––
––– input –––
mysql -h0 -P29306 -e "join cluster a at '127.0.0.1:19312' 'a' as path" &
––– output –––
[1] %{NUMBER}
––– input –––
mysql -h0 -P39306 -e "join cluster b at '127.0.0.1:19312' 'a' as path" &
––– output –––
[2] %{NUMBER}
––– input –––
wait 1>/dev/null 2>&1; echo $?
––– output –––
0
––– input –––
for i in 1 2 3; do grep -q 'FATAL:' /var/log/manticore-${i}/searchd.log ; echo "#$i – $?"; done
––– output –––
#1 – 1
#2 – 1
#3 – 1
––– input –––
for i in 1 2 3; do mysql -h0 -P${i}9306 -e "show status like 'cluster_a_nodes_view'\G" | grep Value; done
––– output –––
Value: 127.0.0.1:19312,127.0.0.1:19322:replication,127.0.0.1:29312,127.0.0.1:29322:replication
Value: 127.0.0.1:19312,127.0.0.1:19322:replication,127.0.0.1:29312,127.0.0.1:29322:replication
––– input –––
for i in 1 2 3; do mysql -h0 -P${i}9306 -e "show status like 'cluster_b_nodes_view'\G" | grep Value; done
––– output –––
Value: 127.0.0.1:19312,127.0.0.1:19324:replication,127.0.0.1:39312,127.0.0.1:39322:replication
Value: 127.0.0.1:19312,127.0.0.1:19324:replication,127.0.0.1:39312,127.0.0.1:39322:replication
