––– input –––
export INSTANCE=1
––– output –––
––– block: ../base/replication/start-searchd-precach –––
––– input –––
export INSTANCE=2
––– output –––
––– block: ../base/replication/start-searchd-precach –––
––– input –––
export CLUSTER_NAME=c
––– output –––
––– block: ../base/replication/create-cluster –––
––– block: ../base/replication/join-cluster-on-all-nodes –––
––– input –––
mysql -h0 -P1306 -e "create table c:tbl1(id bigint) shards=3 rf=1;"; echo $?;
––– output –––
0
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
Type: rt
––– input –––
mysql -h0 -P2306 -e "SHOW TABLES\G"
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES FROM SYSTEM\G;"
––– output –––
––– input –––
mysql -h0 -P2306 -e "SHOW TABLES FROM SYSTEM\G;"
––– output –––
––– input –––
mysql -h0 -P1306 -e "DROP TABLE c:nonexistent_table;"
––– output –––
ERROR 1064 (42000) at line 1: table 'nonexistent_table' is missing: DROP TABLE failed: table 'nonexistent_table' must exist
––– input –––
mysql -h0 -P1306 -e "DROP TABLE nonexistent_cluster:tbl1;"
––– output –––
ERROR 1064 (42000) at line 1: table 'tbl1' is missing: DROP TABLE failed: table 'tbl1' must exist
––– input –––
mysql -h0 -P1306 -e "DROP TABLE c:tbl1;"
––– output –––
ERROR 1064 (42000) at line 1: table 'tbl1' is missing: DROP TABLE failed: table 'tbl1' must exist
––– input –––
mysql -h0 -P1306 -e "INSERT INTO c:tbl1 VALUES (1);" & sleep 1; mysql -h0 -P1306 -e "DROP TABLE c:tbl1;"
––– output –––
[%{NUMBER}] %{NUMBER}
ERROR 1064 (42000) at line 1: Cannot create table with column names missing
[%{NUMBER}]+  Exit %{NUMBER}                  mysql -h0 -P1306 -e "INSERT INTO c:tbl1 VALUES (1);"
ERROR 1064 (42000) at line 1: table 'tbl1' is missing: DROP TABLE failed: table 'tbl1' must exist
––– input –––
for i in {1..20}; do mysql -h0 -P1306 -e "create table c:tbl${i}(id bigint) shards=3 rf=1;"; done
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
––– input –––
for i in {1..20}; do (mysql -h0 -P1306 -e "DROP TABLE c:tbl${i};" &); done
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
––– input –––
mysql -h0 -P1306 -e "create table c:Tbl2(id bigint) shards=3 rf=1;"; echo $?
––– output –––
––– input –––
mysql -h0 -P1306 -e "DROP TABLE c:Tbl2;"; echo $?
––– output –––
––– input –––
mysql -h0 -P1306 -e "create table c:tbl_missing_type(id) shards=3 rf=1;"
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
––– input –––
LONG_TABLE_NAME=$(printf "tbl%065d" 1)
––– output –––
––– input –––
mysql -h0 -P1306 -e "create table c:${LONG_TABLE_NAME}(id bigint) shards=3 rf=1;"
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
––– input –––
mysql -h0 -P1306 -e "DROP TABLE c:${LONG_TABLE_NAME};"
––– output –––
––– input –––
mysql -h0 -P1306 -e "SHOW TABLES\G"
––– output –––
