<test>
<name>quorum</name>

<config>
indexer
{
	mem_limit = 16M
}

searchd
{
	<searchd_settings/>
compat_sphinxql_magics = 1
}

source test1
{
	type = mysql
	<sql_settings/>
	sql_query = SELECT * FROM test_table where document_id in ( 1, 2 )
}

index test
{
	source	= test1
	path	= <data_path/>/test
}

index test_crc
{
	source	= test1
	path	= <data_path/>/crc
	
	dict			= crc
	min_prefix_len	= 1
	enable_star		= 1
}

index test_kw
{
	source	= test1
	path	= <data_path/>/kw
	
	dict			= keywords
	min_prefix_len	= 1
	enable_star		= 1
}

source test2
{
	type = mysql
	<sql_settings/>
	sql_query = SELECT * FROM test_table where document_id in ( 10, 11 )
}

index crc2
{
	source	= test2
	path	= <data_path/>/crc2
	
	dict			= crc
	min_infix_len	= 3
	enable_star		= 1
}
index kw2
{
	source	= test2
	path	= <data_path/>/kw2
	
	dict			= keywords
	min_infix_len	= 3
	enable_star		= 1
}

</config>

<db_create>
CREATE TABLE test_table
(
	document_id INT NOT NULL,
	text VARCHAR(255) NOT NULL
);
</db_create>

<db_drop>
DROP TABLE IF EXISTS test_table;
</db_drop>

<db_insert>
INSERT INTO test_table ( document_id, text ) VALUES
( 1, 'hello world' ),
( 2, 'one two three four five' ),
( 10, 'al all' ),
( 11, 'always' );
</db_insert>

<queries>
	<query mode="extended2" index="test">"hello heaven"/1</query>
	<query mode="extended2" index="test">"hello from above"/2</query>
	<query mode="extended2" index="test">"one two foo bar"/3</query>
	<query mode="extended2" index="test">"one two two bar"/3</query>
	<query mode="extended2" index="test">"one two two bar"/2</query>
	<query mode="extended2" index="test">"two two one three"/3</query>
	<query mode="extended2" index="test">"two two one foo"/3</query>
	
	<!--here is going a couple of regresssion tests-->
	<query mode="extended2" index="test_crc">"o* t*"/2</query>
	<query mode="extended2" index="test_kw">"o* t*"/2</query>
	<query mode="extended2" index="test_crc">"h* w* f*"/2</query>
	<query mode="extended2" index="test_kw">"h* w* f*"/2</query>
	
	<!--here is going regresssion test-->
	<query mode="extended2" index="test_kw">"one t* three four five"</query>
	
	<!--here is going regresssion test-->
	<query mode="extended2" index="crc2">al*</query>
	<query mode="extended2" index="crc2">alw*</query>
	<query mode="extended2" index="kw2">al*</query>
	<query mode="extended2" index="kw2">alw*</query>
	<query mode="extended2" index="crc2">al* | alw*</query>
	<query mode="extended2" index="kw2">al* | alw*</query>
</queries>

</test>
